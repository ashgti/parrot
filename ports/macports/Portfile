# $Id$

PortSystem              1.0

name			parrot
version			0.9.0
categories		lang devel
maintainers             bfulgham coleda.com:will
description		Open source virtual machine
long_description	\
        Parrot is a virtual machine designed to efficiently compile and \
        execute bytecode for dynamic languages. Parrot currently hosts a \
        variety of language implementations in various stages of completion, \
        including Tcl, Javascript, Ruby, Lua, Scheme, PHP, Python, Perl 6, \
        and a .NET bytecode translator.

platforms		darwin
homepage		http://www.parrot.org/
master_sites		ftp://ftp.parrot.org/pub/parrot/releases/devel/0.9.0

checksums		md5 7b70d9b8708e5ed01c210692a7afda0a

depends_build		bin:perl:perl5
depends_lib			port:gmp port:icu

configure.cmd		perl Configure.pl
configure.pre_args	--prefix=${prefix}/lib/parrot
configure.args		--optimize

destroot.target         install

build.type		gnu
build.target		

test.run		yes
test.target		test

destroot.destdir	 PREFIX=${destroot}${prefix}/lib/parrot

# install the docs and create shortcuts for the executables.
post-destroot {
	set bindir	${destroot}${prefix}/bin
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/parrot"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/parrot_config"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/parrot_debugger"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/pbc_disassemble"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/pbc_info"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/pbc_merge"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/pbc_to_exe"
	system "cd ${bindir} && ln -sf ${prefix}/lib/parrot/bin/pbc_dump"

	set docdir      ${destroot}${prefix}/share/doc/${name}
	xinstall -m 755 -d ${docdir}
}

diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/MANIFEST src/parrot-0.6.4/MANIFEST
--- origsrc/parrot-0.6.4/MANIFEST	2008-07-15 09:58:46.000000000 +0000
+++ src/parrot-0.6.4/MANIFEST	2008-07-27 10:54:15.703125000 +0000
@@ -7,10 +7,10 @@
 # format of this file.
 # See docs/submissions.pod on how to recreate this file after SVN
 # has been told about new or deleted files.
-CREDITS                                                     []
-ChangeLog                                                   []
+CREDITS                                                     [devel]doc
+ChangeLog                                                   [devel]doc
 Configure.pl                                                []
-DEPRECATED.pod                                              []
+DEPRECATED.pod                                              [devel]doc
 DONORS.pod                                                  []
 LICENSE                                                     [main]doc
 MANIFEST                                                    []
@@ -22,11 +22,11 @@
 PBC_COMPAT                                                  [devel]doc
 PLATFORMS                                                   [devel]doc
 README                                                      [devel]doc
-README_cygwin.pod                                           []
-README_win32.pod                                            []
+README_cygwin.pod                                           [devel]doc
+README_win32.pod                                            [devel]doc
 RESPONSIBLE_PARTIES                                         [main]doc
 TODO                                                        [main]doc
-VERSION                                                     []
+VERSION                                                     [devel]doc
 apps/p3/README                                              [apps/p3]
 apps/p3/cgi-pir/slides.pir                                  [apps/p3]
 apps/p3/index.html                                          [apps/p3]
@@ -3077,7 +3077,7 @@
 src/pbc_disassemble.c                                       []
 src/pbc_info.c                                              []
 src/pbc_merge.c                                             []
-src/pdb.c                                                   []
+src/parrot_debugger.c                                       []
 src/pdump.c                                                 []
 src/pic.c                                                   []
 src/pic_jit.c                                               []
@@ -3866,7 +3866,7 @@
 t/tools/ops2pmutils/10-print_module.t                       []
 t/tools/ops2pmutils/11-print_h.t                            []
 t/tools/pbc_merge.t                                         []
-t/tools/pdb.t                                               []
+t/tools/parrot_debugger.t                                   []
 t/tools/pmc2c.t                                             []
 t/tools/pmc2cutils/00-qualify.t                             []
 t/tools/pmc2cutils/01-pmc2cutils.t                          []
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/README_cygwin.pod src/parrot-0.6.4/README_cygwin.pod
--- origsrc/parrot-0.6.4/README_cygwin.pod	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/README_cygwin.pod	2008-07-27 10:54:15.703125000 +0000
@@ -6,37 +6,98 @@
 
 =head1 SYNOPSIS
 
-Parrot builds out of the box under Cygwin.  Some tweaks are needed for
-different names of dynamic loading of some dll's.
+Parrot builds out of the box under Cygwin after 
+C<export PATH=`pwd`/blib/lib:$PATH>
+
+There are official cygwin parrot packages available via
+L<http://cygwin.com/setup.exe>.
+
+  parrot libparrot0 libparrot-devel parrot-perl6 parrot-languages
+
+Some tweaks are needed for different names for the ffi to some dll's.
+See L</loadlib DLL versioning>
+
 
 =head1 Packages
 
-You'll need the following Cygwin packages to build Parrot.
+You'll need the following Cygwin packages to run and build Parrot 
+by your own.
 
-=over 4
+Runtime requirements:
+
+  libreadline6 ncurses libintl8 libgmp3 libgdbm4
+
+Optional requirements:
+
+  libicu38 libpq5 openssl
+
+  for opengl: w32api opengl or libglut3 xorg-x11-base xorg-x11-bin-dlls
+
+Build requirements:
+
+  gcc make perl parrot readline libncurses-devel libgmp-devel
+  libgdbm-devel pcre-devel 
+
+Optional build requirements:
+
+  libicu-devel openssl-devel 
+
+  for Cygwin/X opengl: freeglut xorg-x11-devel 
+
+Optional perl packages for testing: 
+
+  L<Test::TAP::HTMLMatrix> if you want to run the language smoke tests
+  with C<make languages-smoke>.
 
-=item gcc
+  L<Test::Base> for some APL language tests.
 
-=item make
+  perl L<Moose> for smartlink
 
-=item perl
+  perl L<Test::Perl::Critic> and L<Perl::Critic>
 
-=item subversion
+=over 4
+
+=item Cygwin subversion and perl
 
 If you use SVN to get a copy of Parrot, you should use the Cygwin SVN
 and not the TortoiseSVN client to avoid build errors.  Similarly you will
 need Cygwin Perl rather than ActiveState or Strawberry Perl.
 
-=item ICU
-
-This is no official Cygwin package yet.  However, icu4c-3_8 builds out of the
-box on Cygwin.
-
-  http://download.icu-project.org/files/icu4c/3.8/icu4c-3_8-src.tgz
+=item icu
 
 Note that ICU is now optional, you can build Parrot without it,
 by not installing it or asking Parrot to ignore it (C<--without-icu>).
 
+=item opengl
+
+You can use the w32api and opengl packages for native Windows opengl support,
+or the freeglut package for the X Server.
+
+Configure.pl will detect freeglut if freeglut is installed and DISPLAY 
+is set, otherwise it checks for w32api and opengl with GLUT.
+
+  Determining if your platform supports OpenGL.............yes, freeglut 3.4.
+  Determining if your platform supports OpenGL...................yes, GLUT 3.
+  Determining if your platform supports OpenGL............................no.
+
+Required packages:
+
+  w32api
+
+or 
+
+  freeglut xorg-x11-devel xorg-x11-base xorg-x11-bin-dlls
+
+=item SDL
+
+SDL references F<cygSDL-1-2-0.dll>, which is only in cygports
+L<http://news.gmane.org/gmane.os.cygwin.ports.announce>
+
+=item aio
+
+libaio-devel "Linux-native asynchronous I/O access" is not available
+for cygwin, and as the name says it will never be :)
+
 =back
 
 =head1 BUILD
@@ -53,21 +114,24 @@
 
 =item Makefile tuning
 
-rename libparrot.dll to cygparrot.dll, create an interim libparrot.dll.a
+Rename libparrot.dll to cygparrot0_6_x.dll and create an interim libparrot.dll.a
 
-fix the blib/lib PATH issue
+  [perl #56998] [TODO]  rename cygwin dll to cygparrot$MAJOR_$MINOR_$PATCH.dll
+  [perl #56562] [PATCH] root.in: add cygwin importlib
 
-=item DLL versioning
+=item loadlib DLL versioning
 
-cyg*-1.1.dll instead of lib*.so.1.1
+Use cyg*-1.1.dll naming conventions instead of lib*.so.1.1 names for loadlib, the
+FFI.
 
-Thanks to the L<Windows DLL Hell / http://> and the impossibility of file
+Thanks to the L<Windows DLL Hell / http://?> and the impossibility of file
 hardlinks, windows dll names are versioned, so the loadlib function or the
 various pir's needs more logic.
 
 Either add the version to each loadlib call, and stem the version from POSIX
 versions within get_path(), or add an optional version argument to loadlib for
-win32. Or just fix all the pir's.
+win32. Or just fix all the pir's, which will be easier when exceptions work 
+again.
 
 =item Features
 
@@ -89,6 +153,6 @@
 
 =head1 HISTORY
 
-Last updated: 1 June 2008
+Last updated: 15 July 2008
 
 =cut
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/compilers/pct/src/PCT/HLLCompiler.pir src/parrot-0.6.4/compilers/pct/src/PCT/HLLCompiler.pir
--- origsrc/parrot-0.6.4/compilers/pct/src/PCT/HLLCompiler.pir	2008-06-18 17:16:40.000000000 +0000
+++ src/parrot-0.6.4/compilers/pct/src/PCT/HLLCompiler.pir	2008-07-27 12:30:30.484375000 +0000
@@ -25,7 +25,6 @@
 
 .sub 'init' :vtable :method
     load_bytecode 'config.pir'
-
     $P0 = split ' ', 'parse past post pir evalpmc'
     setattribute self, '@stages', $P0
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/gcc.pm src/parrot-0.6.4/config/auto/gcc.pm
--- origsrc/parrot-0.6.4/config/auto/gcc.pm	2008-02-23 18:27:32.000000000 +0000
+++ src/parrot-0.6.4/config/auto/gcc.pm	2008-07-27 10:54:15.703125000 +0000
@@ -86,6 +86,7 @@
     print " (yep: $gccversion )" if $verbose;
     $self->set_result('yes');
 
+    # Don't worry about too many redundant warnings in this list.
     my $ccwarn = $conf->data->get('ccwarn');
 
     $conf->data->set( sym_export => '__attribute__ ((visibility("default")))' )
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in src/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in
--- origsrc/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in	2008-03-16 09:53:34.000000000 +0000
+++ src/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in	2008-07-27 10:54:15.703125000 +0000
@@ -5,6 +5,7 @@
 #include <errno.h>
 #include <malloc.h>
 #include <unistd.h>
+#include <string.h>
 #ifndef PAGE_SIZE
 #  define PAGE_SIZE getpagesize()
 #endif
@@ -40,7 +41,7 @@
     if (atoi(argv[1]))
         prot |= PROT_EXEC;
 
-    p = memalign(PAGE_SIZE, sizeof(code));
+    p = memalign(PAGE_SIZE, PAGE_SIZE);
     memcpy(p, code, sizeof(code));
 
     t  = (pf) p;
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/opengl.pm src/parrot-0.6.4/config/auto/opengl.pm
--- origsrc/parrot-0.6.4/config/auto/opengl.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/auto/opengl.pm	2008-07-27 10:54:15.703125000 +0000
@@ -109,11 +109,16 @@
 
  XXXX: No details yet
 
+=head3 Cygwin/w32api
 
-=head3 cygwin
+F<opengl>, F<w32api>
 
- XXXX: No details yet
+=head3 Cygwin/X
+
+F<freeglut>, F<xorg-x11-devel>
 
+This is detected if freeglut is installed and DISPLAY is set.
+It requires an X server.
 
 =cut
 
@@ -163,6 +168,11 @@
         conf            => $conf,
         osname          => $osname,
         cc              => $cc,
+        # Prefer Cygwin/w32api over Cygwin/X, but use X when DISPLAY is set
+        ($^O eq 'cygwin') ?
+         ($ENV{DISPLAY} ? (cygwin => '-lglut -L/usr/X11R6/lib -lGLU -lGL')
+                        : (cygwin => '/usr/bin/glut32.dll -lglu32 -lopengl32')) 
+         : (),
         win32_gcc       => '-lglut32 -lglu32 -lopengl32',
         win32_nongcc    => 'opengl32.lib glu32.lib glut32.lib',
         darwin          => '-framework OpenGL -framework GLUT',
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/warnings.pm src/parrot-0.6.4/config/auto/warnings.pm
--- origsrc/parrot-0.6.4/config/auto/warnings.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/auto/warnings.pm	2008-07-27 10:54:15.703125000 +0000
@@ -11,6 +11,8 @@
 -Wchar-subscripts, etc., that the compiler can support.  Directly hacked
 from F<config/auto/attributes.pm>.
 
+Don't worry about redundant warning flags, automatically implied by -Wall.
+
 =head1 SUBROUTINES
 
 =over 4
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/gen/languages.pm src/parrot-0.6.4/config/gen/languages.pm
--- origsrc/parrot-0.6.4/config/gen/languages.pm	2008-07-02 13:38:41.000000000 +0000
+++ src/parrot-0.6.4/config/gen/languages.pm	2008-07-27 10:54:15.718750000 +0000
@@ -75,7 +75,7 @@
         }
         elsif ( $language eq 'c99' ) {
             $conf->genfile("$langdir/config/makefiles/root.in"     => "$langdir/Makefile");
-            $conf->genfile("$langdir/config/makefiles/cpp.in"      => "$langdir/src/cpp//Makefile");
+            $conf->genfile("$langdir/config/makefiles/cpp.in"      => "$langdir/src/cpp/Makefile");
         }
         elsif ( $language eq 'tcl' ) {
             # tcl has more than one Makefile
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/gen/makefiles/languages.in src/parrot-0.6.4/config/gen/makefiles/languages.in
--- origsrc/parrot-0.6.4/config/gen/makefiles/languages.in	2008-07-02 13:38:41.000000000 +0000
+++ src/parrot-0.6.4/config/gen/makefiles/languages.in	2008-07-27 10:54:15.718750000 +0000
@@ -1,4 +1,4 @@
-# $Id$
+# $Id$ -*- Makefile -*-
 
 # setup of commands
 @make_set_make@
@@ -47,6 +47,12 @@
 	@echo ""
 	@echo "  test-separate: Run 'make test' in the individual lang dirs."
 	@echo ""
+	@echo "  installable:   Create self-hosting bins and libs."
+	@echo ""
+	@echo "  test-installable: Test self-hosting bins and libs."
+	@echo ""
+	@echo "  install:       Copy installable and more to DESTDIR."
+	@echo ""
 	@echo "  clean:         Clean up a lot of languages."
 	@echo ""
 	@echo "  help:          Print this help message."
@@ -60,13 +66,16 @@
 	@echo "Following languages are available:"
 	@echo "  $(LANGUAGES)"
 	@echo ""
-	@echo "A particular language <lang> can be built, tested and cleand up"
+	@echo "A particular language <lang> can be built, tested and cleaned up"
 	@echo "  make <lang>"
 	@echo "  make <lang>.test"
+	@echo "  make <lang>.installable"
+	@echo "  make <lang>.test-installable"
+	@echo "  make <lang>.install"
 	@echo "  make <lang>.clean"
 	@echo "  make <lang>.realclean"
 	@echo ""
-	@echo "For the status of individual languages see LANGUAGES.STATUS.pod"
+	@echo "For the status of individual languages see LANGUAGES_STATUS.pod"
 	@echo ""
 
 # regenerate the Makefile
@@ -98,6 +107,65 @@
     WMLScript.test \
     Zcode.test
 
+installable : all \
+    abc.installable APL.installable \
+    befunge.installable bf.installable \
+    c99.installable cardinal.installable chitchat.installable cola.installable \
+    dotnet.installable \
+    eclectus.installable ecmascript.installable \
+    forth.installable \
+    hq9plus.installable \
+    jako.installable json.installable \
+    lazy-k.installable lisp.installable lolcode.installable lua.installable \
+    m4.installable \
+    ook.installable \
+    parrot_compiler.installable perl6.installable pheme.installable PIR.installable pipp.installable pugs.installable punie.installable pynie.installable \
+    regex.installable \
+    scheme.installable squaak.installable \
+    tcl.installable \
+    urm.installable unlambda.installable \
+    WMLScript.installable \
+    Zcode.installable
+
+test-installable : all \
+    abc.test-installable APL.test-installable \
+    befunge.test-installable bf.test-installable \
+    c99.test-installable cardinal.test-installable chitchat.test-installable cola.test-installable \
+    dotnet.test-installable \
+    eclectus.test-installable ecmascript.test-installable \
+    forth.test-installable \
+    hq9plus.test-installable \
+    jako.test-installable json.test-installable \
+    lazy-k.test-installable lisp.test-installable lolcode.test-installable lua.test-installable \
+    m4.test-installable \
+    ook.test-installable \
+    parrot_compiler.test-installable perl6.test-installable pheme.test-installable PIR.test-installable pipp.test-installable pugs.test-installable punie.test-installable pynie.test-installable \
+    regex.test-installable \
+    scheme.test-installable squaak.test-installable \
+    tcl.test-installable \
+    urm.test-installable unlambda.test-installable \
+    WMLScript.test-installable \
+    Zcode.test-installable
+
+install : all \
+    abc.install APL.install \
+    befunge.install bf.install \
+    c99.install cardinal.install chitchat.install cola.install \
+    dotnet.install \
+    eclectus.install ecmascript.install \
+    forth.install \
+    hq9plus.install \
+    jako.install json.install \
+    lazy-k.install lisp.install lolcode.install lua.install \
+    m4.install \
+    ook.install \
+    parrot_compiler.install perl6.install pheme.install PIR.install pipp.install pugs.install punie.install pynie.install \
+    regex.install \
+    scheme.install squaak.install \
+    tcl.install \
+    urm.install unlambda.install \
+    WMLScript.install \
+    Zcode.install
 
 smoke:  all
 	$(PERL) t/harness --html
@@ -160,6 +228,12 @@
 	- $(MAKE) abc
 abc.test:
 	- $(MAKE) abc test
+abc.installable:
+	- $(MAKE) abc installable
+abc.test-installable:
+	- $(MAKE) abc test-installable
+abc.install:
+	- $(MAKE) abc install
 abc.clean:
 	- $(MAKE) abc clean
 abc.realclean:
@@ -170,6 +244,12 @@
 	- $(MAKE) APL
 APL.test:
 	- $(MAKE) APL test
+APL.installable:
+	- $(MAKE) APL installable
+APL.test-installable:
+	- $(MAKE) APL test-installable
+APL.install:
+	- $(MAKE) APL install
 APL.clean:
 	- $(MAKE) APL clean
 APL.realclean:
@@ -180,6 +260,12 @@
 # don't know how to build BASIC
 BASIC.test:
 # Don't know how to test BASIC
+BASIC.installable:
+# Missing for BASIC
+BASIC.test-installable:
+# Missing for BASIC
+BASIC.install:
+# Missing for BASIC
 BASIC.clean:
 # Don't know how to clean BASIC
 
@@ -188,6 +274,12 @@
 	- $(MAKE) befunge
 befunge.test:
 	- $(MAKE) befunge test
+befunge.installable:
+	- $(MAKE) befunge installable
+befunge.test-installable:
+	- $(MAKE) befunge test-installable
+befunge.install:
+	- $(MAKE) befunge install
 befunge.clean:
 	- $(MAKE) befunge clean
 befunge.realclean:
@@ -198,6 +290,12 @@
 	- $(MAKE) bf
 bf.test:
 	- $(MAKE) bf test
+bf.installable:
+	- $(MAKE) bf installable
+bf.test-installable:
+	- $(MAKE) bf test-installable
+bf.install:
+	- $(MAKE) bf install
 bf.clean:
 	- $(MAKE) bf clean
 bf.realclean:
@@ -208,6 +306,12 @@
 	- $(MAKE) c99
 c99.test:
 	- $(MAKE) c99 test
+c99.installable:
+	- $(MAKE) c99 installable
+c99.test-installable:
+	- $(MAKE) c99 test-installable
+c99.install:
+	- $(MAKE) c99 install
 c99.clean:
 	- $(MAKE) c99 clean
 c99.realclean:
@@ -228,6 +332,12 @@
 	- $(MAKE) chitchat
 chitchat.test:
 	- $(MAKE) chitchat test
+chitchat.installable:
+	- $(MAKE) chitchat installable
+chitchat.test-installable:
+	- $(MAKE) chitchat test-installable
+chitchat.install:
+	- $(MAKE) chitchat install
 chitchat.clean:
 	- $(MAKE) chitchat clean
 chitchat.realclean:
@@ -238,6 +348,12 @@
 	- $(MAKE) cola
 cola.test:
 	- $(MAKE) cola test
+cola.installable:
+	- $(MAKE) cola installable
+cola.test-installable:
+	- $(MAKE) cola test-installable
+cola.install:
+	- $(MAKE) cola install
 cola.clean:
 	- $(MAKE) cola clean
 cola.realclean:
@@ -259,6 +375,12 @@
 	- $(MAKE) eclectus
 eclectus.test :
 	- $(MAKE) eclectus test
+eclectus.installable:
+	- $(MAKE) eclectus installable
+eclectus.test-installable:
+	- $(MAKE) eclectus test-installable
+eclectus.install:
+	- $(MAKE) eclectus install
 eclectus.clean :
 	- $(MAKE) eclectus clean
 eclectus.realclean :
@@ -269,6 +391,12 @@
 	- $(MAKE) ecmascript
 ecmascript.test:
 	- $(MAKE) ecmascript test
+ecmascript.installable:
+	- $(MAKE) ecmascript installable
+ecmascript.test-installable:
+	- $(MAKE) ecmascript test-installable
+ecmascript.install:
+	- $(MAKE) ecmascript install
 ecmascript.clean:
 	- $(MAKE) ecmascript clean
 ecmascript.realclean:
@@ -289,6 +417,12 @@
 	- $(MAKE) hq9plus
 hq9plus.test:
 	- $(MAKE) hq9plus test
+hq9plus.installable:
+	- $(MAKE) hq9plus installable
+hq9plus.test-installable:
+	- $(MAKE) hq9plus test-installable
+hq9plus.install:
+	- $(MAKE) hq9plus install
 hq9plus.clean:
 	- $(MAKE) hq9plus clean
 hq9plus.realclean:
@@ -299,6 +433,12 @@
 	- $(MAKE) jako
 jako.test:
 	- $(MAKE) jako test
+abc.installable:
+	- $(MAKE) jako installable
+jako.test-installable:
+	- $(MAKE) jako test-installable
+jako.install:
+	- $(MAKE) jako install
 jako.clean:
 	- $(MAKE) jako clean
 jako.realclean:
@@ -309,6 +449,12 @@
 	- $(MAKE) json
 json.test:
 	- $(MAKE) json test
+json.installable:
+	- $(MAKE) json installable
+json.test-installable:
+	- $(MAKE) json test-installable
+json.install:
+	- $(MAKE) json install
 json.clean:
 	- $(MAKE) json clean
 json.realclean:
@@ -319,6 +465,12 @@
 	- $(MAKE) lazy-k
 lazy-k.test:
 	- $(MAKE) lazy-k test
+lazy-k.installable:
+	- $(MAKE) lazy-k installable
+lazy-k.test-installable:
+	- $(MAKE) lazy-k test-installable
+lazy-k.install:
+	- $(MAKE) lazy-k install
 lazy-k.clean:
 	- $(MAKE) lazy-k clean
 lazy-k.realclean:
@@ -329,6 +481,12 @@
 	- $(MAKE) lisp
 lisp.test:
 	- $(MAKE) lisp test
+lisp.installable:
+	- $(MAKE) lisp installable
+lisp.test-installable:
+	- $(MAKE) lisp test-installable
+lisp.install:
+	- $(MAKE) lisp install
 lisp.clean:
 	- $(MAKE) lisp clean
 lisp.realclean:
@@ -339,6 +497,12 @@
 	- $(MAKE) lolcode
 lolcode.test:
 	- $(MAKE) lolcode test
+lolcode.installable:
+	- $(MAKE) lolcode installable
+lolcode.test-installable:
+	- $(MAKE) lolcode test-installable
+lolcode.install:
+	- $(MAKE) lolcode install
 lolcode.clean:
 	- $(MAKE) lolcode clean
 lolcode.realclean:
@@ -349,6 +513,12 @@
 	- $(MAKE) lua
 lua.test:
 	- $(MAKE) lua test
+lua.installable:
+	- $(MAKE) lua installable
+lua.test-installable:
+	- $(MAKE) lua test-installable
+lua.install:
+	- $(MAKE) lua install
 lua.clean:
 	- $(MAKE) lua clean
 lua.realclean:
@@ -369,6 +539,12 @@
 	- $(MAKE) ook
 ook.test:
 	- $(MAKE) ook test
+ook.installable:
+	- $(MAKE) ook installable
+ook.test-installable:
+	- $(MAKE) ook test-installable
+ook.install:
+	- $(MAKE) ook install
 ook.clean:
 	- $(MAKE) ook clean
 ook.realclean:
@@ -389,6 +565,12 @@
 	- $(MAKE) perl6
 perl6.test:
 	- $(MAKE) perl6 test
+perl6.installable:
+	- $(MAKE) perl6 installable
+perl6.test-installable:
+	- $(MAKE) perl6 test-installable
+perl6.install:
+	- $(MAKE) perl6 install
 perl6.clean:
 	- $(MAKE) perl6 clean
 perl6.realclean:
@@ -409,6 +591,12 @@
 	- $(MAKE) pipp
 pipp.test:
 	- $(MAKE) pipp test
+pipp.installable:
+	- $(MAKE) pipp installable
+pipp.test-installable:
+	- $(MAKE) pipp test-installable
+pipp.install:
+	- $(MAKE) pipp install
 pipp.clean:
 	- $(MAKE) pipp clean
 pipp.realclean:
@@ -429,6 +617,12 @@
 	- $(MAKE) pugs
 pugs.test:
 	- $(MAKE) pugs test
+pugs.installable:
+	- $(MAKE) pugs installable
+pugs.test-installable:
+	- $(MAKE) pugs test-installable
+pugs.install:
+	- $(MAKE) pugs install
 pugs.clean:
 	- $(MAKE) pugs clean
 pugs.realclean:
@@ -449,6 +643,12 @@
 	- $(MAKE) pynie
 pynie.test:
 	- $(MAKE) pynie test
+pynie.installable:
+	- $(MAKE) pynie installable
+pynie.test-installable:
+	- $(MAKE) pynie test-installable
+pynie.install:
+	- $(MAKE) pynie install
 pynie.clean:
 	- $(MAKE) pynie clean
 pynie.realclean:
@@ -469,6 +669,12 @@
 	@echo "SKIPPED: scheme: (nothing to make, but should not default to make test)"
 scheme.test :
 	- $(MAKE) scheme test
+scheme.installable:
+	- $(MAKE) scheme installable
+scheme.test-installable:
+	- $(MAKE) scheme test-installable
+scheme.install:
+	- $(MAKE) scheme install
 scheme.clean :
 	- $(MAKE) scheme clean
 scheme.realclean :
@@ -489,6 +695,12 @@
 	- $(MAKE) tcl
 tcl.test:
 	- $(MAKE) tcl test
+tcl.installable:
+	- $(MAKE) tcl installable
+tcl.test-installable:
+	- $(MAKE) tcl test-installable
+tcl.install:
+	- $(MAKE) tcl install
 tcl.clean:
 	- $(MAKE) tcl clean
 tcl.realclean:
@@ -509,6 +721,12 @@
 	- $(MAKE) urm
 urm.test:
 	- $(MAKE) urm test
+urm.installable:
+	- $(MAKE) urm installable
+urm.test-installable:
+	- $(MAKE) urm test-installable
+urm.install:
+	- $(MAKE) urm install
 urm.clean:
 	- $(MAKE) urm clean
 urm.realclean:
@@ -519,6 +737,12 @@
 	- $(MAKE) WMLScript
 WMLScript.test:
 	- $(MAKE) WMLScript test
+WMLScript.installable:
+	- $(MAKE) WMLScript installable
+WMLScript.test-installable:
+	- $(MAKE) WMLScript test-installable
+WMLScript.install:
+	- $(MAKE) WMLScript install
 WMLScript.clean:
 	- $(MAKE) WMLScript clean
 WMLScript.realclean:
@@ -529,6 +753,12 @@
 # Do nothing. make Zcode requires an Inform compiler
 Zcode.test:
 	- $(MAKE) Zcode test
+Zcode.installable:
+	- $(MAKE) Zcode installable
+Zcode.test-installable:
+	- $(MAKE) Zcode test-installable
+Zcode.install:
+	- $(MAKE) Zcode install
 Zcode.clean:
 	- $(MAKE) Zcode clean
 Zcode.realclean:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/gen/makefiles/root.in src/parrot-0.6.4/config/gen/makefiles/root.in
--- origsrc/parrot-0.6.4/config/gen/makefiles/root.in	2008-07-15 07:50:15.000000000 +0000
+++ src/parrot-0.6.4/config/gen/makefiles/root.in	2008-07-27 10:54:15.718750000 +0000
@@ -467,7 +467,7 @@
 PDUMP               = $(CUR_DIR)/pdump$(EXE)
 PINFO               = $(CUR_DIR)/pbc_info$(EXE)
 PBCMERGE            = $(CUR_DIR)/pbc_merge$(EXE)
-PDB                 = $(CUR_DIR)/pdb$(EXE)
+PDB                 = $(CUR_DIR)/parrot_debugger$(EXE)
 PBC_TO_EXE          = $(CUR_DIR)/pbc_to_exe$(EXE)
 PARROT_CONFIG       = $(CUR_DIR)/parrot-config$(EXE)
 
@@ -480,7 +480,7 @@
 INSTALLABLEPDUMP    = $(CUR_DIR)/installable_pdump$(EXE)
 INSTALLABLEPINFO    = $(CUR_DIR)/installable_pbc_info$(EXE)
 INSTALLABLEPBCMERGE = $(CUR_DIR)/installable_pbc_merge$(EXE)
-INSTALLABLEPDB      = $(CUR_DIR)/installable_pdb$(EXE)
+INSTALLABLEPDB      = $(CUR_DIR)/installable_parrot_debugger$(EXE)
 
 # Libraries
 LIBPARROT_STATIC    = @blib_dir@/@libparrot_static@
@@ -773,8 +773,8 @@
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/parrot_config$(O) \
     $(MINIPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/main$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS) $(LINK_DYNAMIC) \
-    $(SRC_DIR)/parrot_config$(O)
+    $(SRC_DIR)/main$(O) @rpath_blib@ $(LINKFLAGS) $(LINK_DYNAMIC) \
+    $(SRC_DIR)/parrot_config$(O) $(ALL_PARROT_LIBS)
 
 pbc_to_exe.pir : $(PARROT) tools/dev/pbc_to_exe_gen.pl
 	$(PERL) tools/dev/pbc_to_exe_gen.pl \
@@ -801,15 +801,15 @@
 # TODO build the real miniparrot
 $(MINIPARROT) : $(SRC_DIR)/main$(O) $(GEN_HEADERS) $(LIBPARROT) \
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/null_config$(O)
-	$(LINK) @ld_out@$@ $(SRC_DIR)/main$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS) $(SRC_DIR)/null_config$(O)
+	$(LINK) @ld_out@$@ $(SRC_DIR)/main$(O) $(SRC_DIR)/null_config$(O) \
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INSTALLABLEPARROT) : $(SRC_DIR)/main$(O) $(GEN_HEADERS) $(LIBPARROT) \
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/install_config$(O) \
     $(PARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/main$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS) $(SRC_DIR)/install_config$(O)
+    $(SRC_DIR)/main$(O) $(SRC_DIR)/install_config$(O) \
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INC_DIR)/parrot.h : $(INC_DIR)/pbcversion.h $(INC_DIR)/vtable.h
 
@@ -878,7 +878,8 @@
 $(LIBPARROT_SHARED) : $(O_FILES)
 	$(MKPATH) @blib_dir@
 	$(LD) $(LD_SHARE_FLAGS) $(LDFLAGS) @ld_out@$@ @libparrot_soname@ \
-    $(O_FILES) $(C_LIBS) $(ICU_SHARED)
+#CONDITIONED_LINE(cygchkdll):		-Wl,--out-implib=blib/lib/libparrot.dll.a \
+		$(O_FILES) $(C_LIBS) $(ICU_SHARED)
 #CONDITIONED_LINE(libparrot_shared_alias):	( cd @blib_dir@ ; ln -sf @libparrot_shared@ @libparrot_shared_alias@ )
 
 
@@ -886,17 +887,17 @@
 # Parrot Debugger
 #
 
-$(SRC_DIR)/pdb$(O) : $(GENERAL_H_FILES)
+$(SRC_DIR)/parrot_debugger$(O) : $(GENERAL_H_FILES)
 
-$(PDB) : $(SRC_DIR)/pdb$(O) $(LIBPARROT)
+$(PDB) : $(SRC_DIR)/parrot_debugger$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/pdb$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/parrot_debugger$(O) \
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
-$(INSTALLABLEPDB) : $(SRC_DIR)/pdb$(O) $(LIBPARROT)
+$(INSTALLABLEPDB) : $(SRC_DIR)/parrot_debugger$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/pdb$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/parrot_debugger$(O) \
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Disassembler
@@ -907,12 +908,12 @@
 $(DIS) : $(SRC_DIR)/pbc_disassemble$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_disassemble$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INSTALLABLEDIS) : $(SRC_DIR)/pbc_disassemble$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_disassemble$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Dump
@@ -921,28 +922,28 @@
 $(PDUMP) : $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pdump$(O) \
-    $(SRC_DIR)/packdump$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/packdump$(O) @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(SRC_DIR)/pdump$(O) : $(GEN_HEADERS)
 
 $(INSTALLABLEPDUMP) : $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pdump$(O) \
-    $(SRC_DIR)/packdump$(O) $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/packdump$(O) $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 
 # pbc_info
 $(PINFO) : $(SRC_DIR)/pbc_info$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_info$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(SRC_DIR)/pbc_info$(O) : $(GEN_HEADERS)
 
 $(INSTALLABLEPINFO) : $(SRC_DIR)/pbc_info$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_info$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Bytecode File Merger
@@ -959,7 +960,7 @@
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_merge$(O) \
     $(SRC_DIR)/install_config$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 
 ###############################################################################
@@ -1606,7 +1607,7 @@
     $(IMCC_DIR)/main$(O) \
     $(PDUMP) $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) \
     $(SRC_DIR)/pbc_info$(O) $(PINFO) \
-    $(PDB) $(SRC_DIR)/pdb$(O) \
+    $(PDB) $(SRC_DIR)/parrot_debugger$(O) \
     $(PBCMERGE) $(SRC_DIR)/pbc_merge$(O) \
     $(DIS) $(SRC_DIR)/pbc_disassemble$(O) \
     $(SRC_DIR)/main$(O) \
@@ -1642,7 +1643,7 @@
     $(IMCC_DIR)/main$(O) \
     $(PDUMP) $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) \
     $(SRC_DIR)/pbc_info$(O) $(PINFO) \
-    $(PDB) $(SRC_DIR)/pdb$(O) \
+    $(PDB) $(SRC_DIR)/parrot_debugger$(O) \
     $(PBCMERGE) $(SRC_DIR)/pbc_merge$(O) \
     $(DIS) $(SRC_DIR)/pbc_disassemble$(O) \
     $(SRC_DIR)/null_config$(O) \
@@ -1720,7 +1721,7 @@
 	$(RM_F) \
      "t/tools/pmc2c.t_*" \
      "t/tools/pmc2c.pmc_t_*" \
-     "t/tools/pdb.t.*"
+     "t/tools/parrot_debugger.t.*"
 	$(RM_F) \
      "test$(EXE)" \
      "test.*"
@@ -2164,7 +2165,7 @@
 ###############################################################################
 
 exec : $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) $(LIBPARROT)
-	$(LINK) @ld_out@$(EXEC)$(EXE) $(EXEC)$(O) $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+	$(LINK) @ld_out@$(EXEC)$(EXE) $(EXEC)$(O) $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 ###### OS depend targets ##########
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/init/hints/cygwin.pm src/parrot-0.6.4/config/init/hints/cygwin.pm
--- origsrc/parrot-0.6.4/config/init/hints/cygwin.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/init/hints/cygwin.pm	2008-07-27 10:54:15.718750000 +0000
@@ -13,18 +13,30 @@
     # in the standard installation, so we get rid of it
     my $libs = $conf->data->get('libs');
     $libs =~ s/-lutil\b//g;
+    # same for -lm and -dl
+    $libs =~ s/-lm\b//g;
+    $libs =~ s/-ldl\b//g;
 
     my $build_dir = $conf->data->get('build_dir');
     $build_dir =~ s/ /\\ /g;
+    my $libparrot_shared = $conf->data->get('libparrot_shared');
+    # force cyg prefix
+    $libparrot_shared =~ s/^lib/cyg/g;
+    # force the dll versioning
+    my @parrot_version = Parrot::BuildUtil::parrot_version();
+    my $dllsuffix = join("_",@parrot_version);
+    $libparrot_shared =~ s/parrot\.dll/parrot$dllsuffix\.dll/;
 
-    # A note about building shared libraries:  Perl5 uses the 'ld2' tool, which
-    # is installed as part of the perl5 installation.  So far, it appears
-    # parrot can get by with simply using gcc -shared, so we override the
-    # perl5 Configure defaults and use 'gcc -shared' instead of 'ld2'.
+    # An old note about building shared libraries: Perl5.8 used the
+    # 'ld2' tool, which is installed as part of the perl5 installation.
+    # So far, it appears parrot can get by with simply using gcc -shared,
+    # so we override the perl5 Configure defaults and use 'gcc -shared'
+    # instead of 'ld2'.
     # If this later causes problems, it might be worth revisiting.
     # A. Dougherty 9/9/2002
     $conf->data->set(
         build_dir           => $build_dir,
+	libparrot_shared    => $libparrot_shared,
         ld                  => 'gcc',
         ld_share_flags      => '-shared',
         ld_load_flags       => '-shared',
@@ -37,6 +49,7 @@
         cygchkdll           => 'tools/build/cygchkdll.sh $(MINIPARROT) $(LIBPARROT)',
     );
 
+
     # inet_aton needs to be defined on Cygwin.
     my $define = $conf->options->get('define');
     unless ($define) {
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/inter/libparrot.pm src/parrot-0.6.4/config/inter/libparrot.pm
--- origsrc/parrot-0.6.4/config/inter/libparrot.pm	2008-05-11 13:27:01.000000000 +0000
+++ src/parrot-0.6.4/config/inter/libparrot.pm	2008-07-27 10:54:15.718750000 +0000
@@ -46,6 +46,8 @@
     # of the shared parrot library. However, 'libparrot.so' will catch
     # at least some of the problems.
     # RT#52288: the check for old_versions should be improved
+    # The cygwin build with a preexisting libparrot.dll in the PATH
+    # works fine if blib/lib is in the PATH before.
     my $old_version
         = File::Spec->catfile($conf->data->get('libdir'), 'libparrot.so');
     if (-e $old_version) {
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/debug.pod src/parrot-0.6.4/docs/debug.pod
--- origsrc/parrot-0.6.4/docs/debug.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/debug.pod	2008-07-27 10:54:15.718750000 +0000
@@ -75,10 +75,10 @@
 Let's say you have written (or generated) a huge .pasm or .pir file.  It's not
 working. You'd like some help in figuring out why.
 
-=head2 pdb
+=head2 parrot_debugger
 
-One possible tool is C<pdb>, the Parrot Debugger. See F<docs/debugger.pod> for
-details on it.
+One possible tool is C<parrot_debugger>, the Parrot Debugger. See
+F<docs/debugger.pod> for details on it.
 
 =head2 stabs
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/debugger.pod src/parrot-0.6.4/docs/debugger.pod
--- origsrc/parrot-0.6.4/docs/debugger.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/debugger.pod	2008-07-27 10:54:15.734375000 +0000
@@ -7,20 +7,20 @@
 
 =head1 ABSTRACT
 
-This document describes F<pdb>, the Parrot Debugger.
+This document describes F<parrot_debugger>, the Parrot Debugger.
 
 =head1 DESCRIPTION
 
 Starting from version 0.0.6 Parrot has its own debugger, which is modeled after
-Perl's one. Its name is F<pdb>, and is an interactive environment that let you
-step through bytecode, set breakpoints, evaluate assembly instructions and peek
-at the interpreter status.
+Perl's one. Its name is F<parrot_debugger>, and is an interactive environment
+that let you step through bytecode, set breakpoints, evaluate assembly
+instructions and peek at the interpreter status.
 
 A good (well, at least some) knowledge of the Parrot internals is obviously
 required to read this document. Some familiarity with debugging principles is
 also mandatory beyond this point.
 
-=head1 BUILDING pdb
+=head1 BUILDING parrot_debugger
 
 The debugger is not built with Parrot, but you should make it with its specific
 target:
@@ -29,18 +29,18 @@
 
 (where C<make> is the same C<make> incarnation you used to build Parrot).
 
-If everything goes well, you should come up with a F<pdb> executable in the
-same directory as the Parrot program.
+If everything goes well, you should come up with a F<parrot_debugger> executable
+in the same directory as the Parrot program.
 
 =head1 THE DEBUGGER SHELL
 
 To start the debugger type:
 
-  pdb file.pbc
+  parrot_debugger file.pbc
 
-That is, F<pdb> takes exactly one argument, which is the Parrot bytecode that
-you're going to debug. F<pdb> will automatically load and disassemble the
-bytecode file for you.
+That is, F<parrot_debugger> takes exactly one argument, which is the Parrot
+bytecode that you're going to debug. F<parrot_debugger> will automatically load
+and disassemble the bytecode file for you.
 
 Note that you can't pass command line arguments to your program when you invoke
 the debugger. See the C<run (r)> command below for this.
@@ -49,8 +49,8 @@
 
   (pdb)
 
-F<pdb> is ready to receive commands and give output. To list the available
-commands type 'h'. To quit the debugger type 'q'.
+F<parrot_debugger> is ready to receive commands and give output. To list the
+available commands type 'h'. To quit the debugger type 'q'.
 
 As with the Perl debugger, whenever it halts and shows you a line of code, it
 is always the line it's I<about> to execute, not the one that it has just
@@ -69,10 +69,10 @@
 
 A blank line always repeats the last command entered.
 
-Also note that at this point in its development, F<pdb> has very poor error
-checking on commands and their arguments, so type carefully or something bad
-will happen. Feel free to report bugs, or better yet patch the source code (see
-L</FILES> below).
+Also note that at this point in its development, F<parrot_debugger> has very
+poor error checking on commands and their arguments, so type carefully or
+something bad will happen. Feel free to report bugs, or better yet patch the
+source code (see L</FILES> below).
 
 =over 4
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/parrot.pod src/parrot-0.6.4/docs/parrot.pod
--- origsrc/parrot-0.6.4/docs/parrot.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/parrot.pod	2008-07-27 10:54:15.734375000 +0000
@@ -112,7 +112,7 @@
 
 =item F<debugger.pod>
 
-Documentation for C<pdb>, the Parrot debugger.
+Documentation for C<parrot_debugger>, the Parrot debugger.
 
 =back
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/editor/parrot.el src/parrot-0.6.4/editor/parrot.el
--- origsrc/parrot-0.6.4/editor/parrot.el	2008-02-26 18:33:25.000000000 +0000
+++ src/parrot-0.6.4/editor/parrot.el	2008-07-27 10:54:15.734375000 +0000
@@ -8,7 +8,7 @@
 ;; To use this file, copy it to a known location and add this statement to
 ;; your .emacs file:
 ;;
-;;   (load-file "/known/location/parrot.el")
+;;   (load-file "/usr/share/emacs/site-lisp/parrot.el")
 ;;
 
 (c-add-style "parrot"
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/APL/config/makefiles/root.in src/parrot-0.6.4/languages/APL/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/APL/config/makefiles/root.in	2008-06-24 17:19:59.000000000 +0000
+++ src/parrot-0.6.4/languages/APL/config/makefiles/root.in	2008-07-27 10:54:15.734375000 +0000
@@ -1,12 +1,17 @@
-## $Id$
+## $Id$ -*- Makefile -*-
 
 ## arguments we want to run parrot with
 PARROT_ARGS =
 
 ## configuration settings
+LANG	      = APL
 BUILD_DIR     = @build_dir@
 LOAD_EXT      = @load_ext@
 O             = @o@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 ## Setup some commands
 LN_S          = @lns@
@@ -15,8 +20,10 @@
 CP            = @cp@
 PARROT        = ../../parrot@exe@
 CAT           = $(PERL) -MExtUtils::Command -e cat
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 BUILD_DYNPMC  = $(PERL) $(BUILD_DIR)/tools/build/dynpmc.pl
 RECONFIGURE   = $(PERL) $(BUILD_DIR)/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
@@ -42,11 +49,18 @@
 
 PMCS = aplvector
 PMC_SOURCES = $(PMC_DIR)/aplvector.pmc
+DOCS = MAINTAINER README STATUS
 
 # the default target
 APL.pbc: $(PARROT) $(SOURCES) $(APL_GROUP)
 	$(PARROT) $(PARROT_ARGS) -o APL.pbc APL.pir
 
+$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc
+
+installable_$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc --install
+
 src/gen_grammar.pir: $(PERL6GRAMMAR) src/parser/grammar.pg
 	$(PARROT) $(PARROT_ARGS) $(PERL6GRAMMAR) \
 	    --encoding=utf8 \
@@ -66,9 +80,13 @@
 	cd $(PMC_DIR) && $(BUILD_DYNPMC) linklibs $(PMCS)
 	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
 
+installable : installable_$(LANG)@exe@ $(ABC_GROUP)
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
+
 # regenerate the Makefile
 Makefile: config/makefiles/root.in
-	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=APL
+	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=$(LANG)
 
 # This is a listing of all targets, that are meant to be called by users
 help:
@@ -77,8 +95,11 @@
 	@echo ""
 	@echo "  all:               APL.pbc"
 	@echo "                     This is the default."
+	@echo "  install:           install the installable targets and docs."
+	@echo ""
 	@echo "Testing:"
 	@echo "  test:              Run the test suite."
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo "  testclean:         Clean up test results."
 	@echo ""
 	@echo "Cleaning:"
@@ -93,6 +114,16 @@
 test: all
 	$(PERL) t/harness
 
+# TODO: test for installed libs, rename build_dir. basic run for missing libs
+test-installable : installable
+	./installable_$(LANG)@exe@ demo.apl
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	pod2man $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
 testclean:
 	$(RM_F) t/*.pir
 
@@ -111,6 +142,8 @@
   $(PMC_DIR)/*.manifest \
   $(PMC_DIR)/*.pdb \
   $(PMC_DIR)/*.lib \
+  $(LANG)@exe@ \
+  installable_$(LANG)@exe@ \
 
 
 clean: testclean
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/abc/config/makefiles/root.in src/parrot-0.6.4/languages/abc/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/abc/config/makefiles/root.in	2008-06-24 17:20:00.000000000 +0000
+++ src/parrot-0.6.4/languages/abc/config/makefiles/root.in	2008-07-27 10:54:15.734375000 +0000
@@ -1,12 +1,17 @@
-# $Id$
+# $Id$ -*- Makefile -*-
 
 ## arguments we want to run parrot with
 PARROT_ARGS =
 
 ## configuration settings
+LANG          = abc
 BUILD_DIR     = @build_dir@
 LOAD_EXT      = @load_ext@
 O             = @o@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 ## Setup some commands
 LN_S          = @lns@
@@ -15,8 +20,10 @@
 CP            = @cp@
 PARROT        = ../../parrot@exe@
 CAT           = $(PERL) -MExtUtils::Command -e cat
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 BUILD_DYNPMC  = $(PERL) $(BUILD_DIR)/tools/build/dynpmc.pl
 RECONFIGURE   = $(PERL) $(BUILD_DIR)/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
@@ -45,11 +52,15 @@
 
 # PMCS = abc
 # PMC_SOURCES = $(PMC_DIR)/abc.pmc
+DOCS = MAINTAINER README TODO
 
 # the default target
 abc.pbc: $(PARROT) $(SOURCES)
 	$(PARROT) $(PARROT_ARGS) -o abc.pbc abc.pir
 
+$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc
+
 src/gen_grammar.pir: $(PERL6GRAMMAR) src/parser/grammar.pg src/parser/grammar-oper.pg
 	$(PARROT) $(PARROT_ARGS) $(PERL6GRAMMAR) \
 	    --output=src/gen_grammar.pir \
@@ -69,9 +80,16 @@
 	cd $(PMC_DIR) && $(BUILD_DYNPMC) linklibs $(PMCS)
 	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
 
+installable : installable_$(LANG)@exe@ $(ABC_GROUP)
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
+
+installable_$(LANG)@exe@ : $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc --install
+
 # regenerate the Makefile
 Makefile: config/makefiles/root.in
-	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=abc
+	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=$(LANG)
 
 # This is a listing of all targets, that are meant to be called by users
 help:
@@ -80,8 +98,11 @@
 	@echo ""
 	@echo "  all:               abc.pbc"
 	@echo "                     This is the default."
+	@echo "  install:           install the installable targets and docs."
+	@echo ""
 	@echo "Testing:"
 	@echo "  test:              Run the test suite."
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo "  testclean:         Clean up test results."
 	@echo ""
 	@echo "Cleaning:"
@@ -96,6 +117,16 @@
 test: all
 	prove -r t
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	echo "2-1" | ./installable_$(LANG)@exe@
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	$(POD2MAN) $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
 testclean:
 	$(RM_RF) "t/*.pir" "t/*.out"
 
@@ -114,7 +145,8 @@
   $(PMC_DIR)/*.manifest \
   $(PMC_DIR)/*.pdb \
   $(PMC_DIR)/*.lib \
-
+  $(LANG)@exe@ \
+  installable_$(LANG)@exe@ \
 
 clean: testclean
 	$(RM_RF) $(CLEANUPS)
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/befunge/config/makefiles/root.in src/parrot-0.6.4/languages/befunge/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/befunge/config/makefiles/root.in	2008-06-24 17:20:00.000000000 +0000
+++ src/parrot-0.6.4/languages/befunge/config/makefiles/root.in	2008-07-27 10:54:15.734375000 +0000
@@ -1,31 +1,44 @@
-# $Id$
+# $Id$ -*- Makefile -*-
 
 # Makefile for languages/befunge
+LANG = befunge
+
+## configuration settings
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 # Setup of some commands
 PARROT     = ../../parrot
 PERL       = @perl@
 RM_F       = @rm_f@
+POD2MAN	   = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
 
+DOCS = MAINTAINER README Changes
+
 default: all
 
 help :
 	@echo ""
 	@echo "Following targets are available for the user:"
 	@echo ""
-	@echo "  build:             Create befunge.pbc"
+	@echo "  all:               befunge.pbc"
 	@echo "                     This is the default."
 	@echo ""
-	@echo "  test:              run the test suite,"
+	@echo "  install:           Install the installable targets and docs."
 	@echo ""
-	@echo "  clean:             clean up temporary files"
+	@echo "  test:              Run the test suite,"
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo ""
-	@echo "  realclean:         clean up generated files"
+	@echo "  clean:             Clean up temporary files"
 	@echo ""
-	@echo "  help:              print this help message"
+	@echo "  realclean:         Clean up generated files"
+	@echo ""
+	@echo "  help:              Print this help message"
 
 
 all: build
@@ -35,8 +48,28 @@
 befunge.pbc: befunge.pasm debug.pasm flow.pasm io.pasm load.pasm maths.pasm stack.pasm
 	$(PARROT) -o befunge.pbc befunge.pasm
 
+installable_$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc --install
+
+installable : installable_$(LANG)@exe@
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+
+# regenerate the Makefile
+Makefile: config/makefiles/root.in
+	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=$(LANG)
+
 test: befunge.pbc
-	cd .. && $(PERL) t/harness --languages=befunge
+	cd .. && $(PERL) t/harness --languages=$(LANG)
+
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	./installable_$(LANG)@exe@ test.bef
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	$(POD2MAN) $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
 
 clean:
 	$(RM_F) core \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/bf/config/makefiles/root.in src/parrot-0.6.4/languages/bf/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/bf/config/makefiles/root.in	2008-06-24 17:19:59.000000000 +0000
+++ src/parrot-0.6.4/languages/bf/config/makefiles/root.in	2008-07-27 10:54:15.734375000 +0000
@@ -1,11 +1,21 @@
+# -*- Makefile -*-
+LANG = bf
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
+
 RM_F = @rm_f@
 PERL = @perl@
-PARROT=../../parrot
+PARROT = ../../parrot@exe@
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
 
-default: build
+DOCS = MAINTAINER README
+
+all : build
 
 help :
 	@echo ""
@@ -22,11 +32,31 @@
 	@echo ""
 	@echo "  help:              print this help message"
 
-test: build
+test : build
 	$(PERL) -Ilib -I../../lib t/harness
 
 build: bf.pbc bfc.pbc bfco.pbc
 
+installable: installable_bf@exe@ installable_bfc@exe@ installable_bfco@exe@
+
+bf@exe@: bf.pbc
+	$(PBC_TO_EXE) bf.pbc
+
+bfc@exe@: bfc.pbc
+	$(PBC_TO_EXE) bfc.pbc
+
+bfco@exe@: bfco.pbc
+	$(PBC_TO_EXE) bfco.pbc
+
+installable_bf@exe@: bf.pbc
+	$(PBC_TO_EXE) bf.pbc --install
+
+installable_bfc@exe@: bfc.pbc
+	$(PBC_TO_EXE) bfc.pbc --install
+
+installable_bfco@exe@: bfco.pbc
+	$(PBC_TO_EXE) bfco.pbc --install
+
 bf.pbc: bf.pasm
 	$(PARROT) -o bf.pbc bf.pasm
 
@@ -36,6 +66,20 @@
 bfco.pbc: bfco.pir
 	$(PARROT) -o bfco.pbc bfco.pir
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	./installable_bf@exe@ test.bf
+	./installable_bfc@exe@ test.bf
+	./installable_bfco@exe@ test.bf
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	cp installable_bfc@exe@ $(DESTDIR)$(BIN_DIR)/parrot-bfc@exe@
+	cp installable_bfco@exe@ $(DESTDIR)$(BIN_DIR)/parrot-bfco@exe@
+	pod2man $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
 clean:
 	$(RM_F) core "*.pbc" "*~"
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/c99/config/makefiles/root.in src/parrot-0.6.4/languages/c99/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/c99/config/makefiles/root.in	2008-06-24 17:20:00.000000000 +0000
+++ src/parrot-0.6.4/languages/c99/config/makefiles/root.in	2008-07-27 10:54:15.750000000 +0000
@@ -1,12 +1,17 @@
-## $Id$
+## $Id$ -*- Makefile -*-
 
 ## arguments we want to run parrot with
 PARROT_ARGS =
 
 ## configuration settings
+LANG          = c99
 BUILD_DIR     = @build_dir@
 LOAD_EXT      = @load_ext@
 O             = @o@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 ## Setup some commands
 LN_S          = @lns@
@@ -15,8 +20,10 @@
 CP            = @cp@
 PARROT        = ../../parrot@exe@
 CAT           = $(PERL) -MExtUtils::Command -e cat
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 BUILD_DYNPMC  = $(PERL) $(BUILD_DIR)/tools/build/dynpmc.pl
 RECONFIGURE   = $(PERL) $(BUILD_DIR)/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
@@ -29,8 +36,9 @@
 PCT           = $(BUILD_DIR)/runtime/parrot/library/PCT.pbc
 
 PMC_DIR       = src/pmc
+DOCS = MAINTAINER
 
-all: c99.pbc
+all: c99.pbc src/cpp/cpp.pbc
 
 C_GROUP = $(PMC_DIR)/c_group$(LOAD_EXT)
 
@@ -51,6 +59,22 @@
 	$(PARROT) $(PARROT_ARGS) -o c99.pbc c99.pir
 	cd src/cpp; $(MAKE)
 
+c99@exe@: c99.pbc
+	$(PBC_TO_EXE) c99.pbc
+
+installable : installable_c99@exe@ installable_cpp@exe@
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+	cp installable_cpp@exe@ $(BUILD_DIR)
+
+installable_c99@exe@ : c99.pbc
+	$(PBC_TO_EXE) c99.pbc --install
+
+installable_cpp@exe@ : src/cpp/cpp.pbc
+	cd src/cpp
+	$(PBC_TO_EXE) cpp.pbc --install
+	mv installable_cpp@exe@ ../../installable_cpp@exe@
+	cd ../..
+
 src/gen_grammar.pir: $(PERL6GRAMMAR) src/parser/grammar.pg
 	$(PARROT) $(PARROT_ARGS) $(PERL6GRAMMAR) \
 	    --output=src/gen_grammar.pir \
@@ -71,17 +95,20 @@
 
 # regenerate the Makefile
 Makefile: config/makefiles/root.in
-	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=c
+	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=c99
 
 # This is a listing of all targets, that are meant to be called by users
 help:
 	@echo ""
 	@echo "Following targets are available for the user:"
 	@echo ""
-	@echo "  all:               c.pbc"
+	@echo "  all:               c99.pbc"
 	@echo "                     This is the default."
+	@echo "  install:           install the installable targets and docs."
+	@echo ""
 	@echo "Testing:"
 	@echo "  test:              Run the test suite."
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo "  testclean:         Clean up test results."
 	@echo ""
 	@echo "Cleaning:"
@@ -96,6 +123,19 @@
 test: all
 	$(PERL) t/harness
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	./installable_$(LANG)@exe@ t/spi.t
+	./installable_cpp@exe@ t/spi.t
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	cp installable_cpp@exe@ $(DESTDIR)$(BIN_DIR)/parrot-cpp@exe@
+	$(POD2MAN) $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	$(POD2MAN) src/cpp/cpp.pir > $(DESTDIR)$(MANDIR)/man1/parrot-cpp.1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
 # this target has nothing to do
 testclean:
 
@@ -117,8 +157,8 @@
   src/cpp/cpp.pbc \
   src/cpp/src/gen_actions.pir \
   src/cpp/src/gen_grammar.pir \
-  src/cpp/src/gen_builtins.pir
-
+  src/cpp/src/gen_builtins.pir \
+  installable_*@exe@
 
 clean:
 	$(RM_RF) $(CLEANUPS)
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/cardinal/config/makefiles/root.in src/parrot-0.6.4/languages/cardinal/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/cardinal/config/makefiles/root.in	2008-06-24 17:19:59.000000000 +0000
+++ src/parrot-0.6.4/languages/cardinal/config/makefiles/root.in	2008-07-27 10:54:15.750000000 +0000
@@ -1,12 +1,17 @@
-## $Id$
+## $Id$ -*- Makefile -*-
 
 ## arguments we want to run parrot with
 PARROT_ARGS =
 
 ## configuration settings
+LANG          = cardinal
 BUILD_DIR     = @build_dir@
 LOAD_EXT      = @load_ext@
 O             = @o@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 ## Setup some commands
 LN_S          = @lns@
@@ -15,8 +20,10 @@
 CP            = @cp@
 PARROT        = ../../parrot@exe@
 CAT           = $(PERL) -MExtUtils::Command -e cat
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 BUILD_DYNPMC  = $(PERL) $(BUILD_DIR)/tools/build/dynpmc.pl
 RECONFIGURE   = $(PERL) $(BUILD_DIR)/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
@@ -29,6 +36,7 @@
 PCT           = $(BUILD_DIR)/runtime/parrot/library/PCT.pbc
 
 PMC_DIR       = src/pmc
+DOCS = 
 
 all: cardinal.pbc
 
@@ -57,6 +65,9 @@
 cardinal.pbc: $(PARROT) $(SOURCES)
 	$(PARROT) $(PARROT_ARGS) -o cardinal.pbc cardinal.pir
 
+cardinal@exe@: cardinal.pbc
+	$(PBC_TO_EXE) cardinal.pbc
+
 src/gen_grammar.pir: $(PERL6GRAMMAR) src/parser/grammar.pg
 	$(PARROT) $(PARROT_ARGS) $(PERL6GRAMMAR) \
 	    --output=src/gen_grammar.pir \
@@ -79,6 +90,13 @@
 Makefile: config/makefiles/root.in
 	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=cardinal
 
+installable_$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc --install
+
+installable : installable_$(LANG)@exe@
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+
+
 # This is a listing of all targets, that are meant to be called by users
 help:
 	@echo ""
@@ -86,8 +104,11 @@
 	@echo ""
 	@echo "  all:               cardinal.pbc"
 	@echo "                     This is the default."
+	@echo "  install:           Install the installable targets and docs."
+	@echo ""
 	@echo "Testing:"
 	@echo "  test:              Run the test suite."
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo "  testclean:         Clean up test results."
 	@echo ""
 	@echo "Cleaning:"
@@ -102,11 +123,21 @@
 test: all
 	$(PERL) t/harness
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	./installable_$(LANG)@exe@ t/00-sanity.t
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	pod2man $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+
 # this target has nothing to do
 testclean:
 
 CLEANUPS = \
   cardinal.pbc \
+  cardinal@exe@ \
+  installable_cardinal@exe@ \
   src/gen_grammar.pir \
   src/gen_actions.pir \
   src/gen_builtins.pir \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/chitchat/config/makefiles/root.in src/parrot-0.6.4/languages/chitchat/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/chitchat/config/makefiles/root.in	2008-06-24 17:19:59.000000000 +0000
+++ src/parrot-0.6.4/languages/chitchat/config/makefiles/root.in	2008-07-27 10:54:15.750000000 +0000
@@ -1,12 +1,17 @@
-## $Id$
+## $Id$ -*- Makefile -*-
 
 ## arguments we want to run parrot with
 PARROT_ARGS =
 
 ## configuration settings
+LANG          = chitchat
 BUILD_DIR     = @build_dir@
 LOAD_EXT      = @load_ext@
 O             = @o@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
 
 ## Setup some commands
 LN_S          = @lns@
@@ -15,8 +20,10 @@
 CP            = @cp@
 PARROT        = ../../parrot@exe@
 CAT           = $(PERL) -MExtUtils::Command -e cat
+PBC_TO_EXE    = ../../pbc_to_exe@exe@
 BUILD_DYNPMC  = $(PERL) $(BUILD_DIR)/tools/build/dynpmc.pl
 RECONFIGURE   = $(PERL) $(BUILD_DIR)/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
@@ -29,6 +36,7 @@
 PCT           = $(BUILD_DIR)/runtime/parrot/library/PCT.pbc
 
 PMC_DIR       = src/pmc
+DOCS = MAINTAINER
 
 all: chitchat.pbc
 
@@ -79,8 +87,11 @@
 	@echo ""
 	@echo "  all:               chitchat.pbc"
 	@echo "                     This is the default."
+	@echo "  install:           install the installable targets and docs."
+	@echo ""
 	@echo "Testing:"
 	@echo "  test:              Run the test suite."
+	@echo "  test-installable:  Test self-hosting targets."
 	@echo "  testclean:         Clean up test results."
 	@echo ""
 	@echo "Cleaning:"
@@ -95,6 +106,26 @@
 test: all
 	$(PERL) t/harness
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	echo "2-1" | ./installable_$(LANG)@exe@
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	$(POD2MAN) $(LANG).pir > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
+$(LANG)@exe@: $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc
+
+installable : installable_$(LANG)@exe@ $(CHITCHAT_GROUP)
+	cp installable_$(LANG)@exe@ $(BUILD_DIR)
+	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
+
+installable_$(LANG)@exe@ : $(LANG).pbc
+	$(PBC_TO_EXE) $(LANG).pbc --install
+
 # this target has nothing to do
 testclean:
 
@@ -113,7 +144,8 @@
   $(PMC_DIR)/*.manifest \
   $(PMC_DIR)/*.pdb \
   $(PMC_DIR)/*.lib \
-
+  $(LANG)@exe@ \
+  installable_$(LANG)@exe@ \
 
 clean:
 	$(RM_RF) $(CLEANUPS)
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/cola/config/makefiles/root.in src/parrot-0.6.4/languages/cola/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/cola/config/makefiles/root.in	2008-06-24 17:20:00.000000000 +0000
+++ src/parrot-0.6.4/languages/cola/config/makefiles/root.in	2008-07-27 10:54:15.750000000 +0000
@@ -1,7 +1,17 @@
-# $Id$
+# $Id$ -*- Makefile -*-
 
 # Makefile for languages/cola
 
+## configuration settings
+LANG          = cola
+BUILD_DIR     = @build_dir@
+O             = @o@
+EXE           = @exe@
+BIN_DIR       = @bin_dir@
+LIB_DIR       = @lib_dir@
+DOC_DIR       = @doc_dir@
+MANDIR	      = @mandir@
+
 # Set up commands
 PERL          = @perl@
 RM_F          = @rm_f@
@@ -11,17 +21,11 @@
 YACC          = @yacc@
 LEX           = @lex@
 RECONFIGURE   = $(PERL) @build_dir@/tools/dev/reconfigure.pl
+POD2MAN	      = pod2man
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
 
-# Set up extensions
-O             = @o@
-EXE           = @exe@
-
-# Set up directories
-BUILD_DIR     = @build_dir@
-
 # Libraries:  Ordinarily, no special libraries are needed
 # for cola, but one of the following settings might be helpful
 # in some cases.
@@ -44,8 +48,9 @@
 # LIBS = -lefence
 
 HEADERS = cola.h parser.h
+DOCS = MAINTAINER README examples/*
 
-default :
+all : colacc$(EXE)
 	$(MAKE) colacc$(EXE)
 	-$(CHMOD) 775 colacc$(EXE)
 
@@ -53,8 +58,9 @@
 	@echo ""
 	@echo "Following targets are available for the user:"
 	@echo ""
-	@echo "  default  :         build 'colacc'"
+	@echo "  all  :             build 'colacc'"
 	@echo "                     This is the default."
+	@echo "  install:           install the installable targets and docs."
 	@echo ""
 	@echo "  test:              run the test suite"
 	@echo ""
@@ -68,7 +74,7 @@
 
 # regenerate the Makefile
 Makefile: config/makefiles/root.in
-	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=cola
+	cd $(BUILD_DIR) && $(RECONFIGURE) --step=gen::languages --languages=$(LANG)
 
 nogen : gen$(O) semant$(O) sym$(O) type$(O)
 	$(CC) $(DEBUG) -c parser.c
@@ -93,11 +99,11 @@
 	$(RM_F) parser.h
 	$(RM_F) lexer.c parser.c
 
-publish :
-	$(PERL) publish.pl < MANIFEST
-
-dist :
-	$(PERL) distribution.pl < MANIFEST
+#publish :
+#	$(PERL) publish.pl < MANIFEST
+#
+#dist :
+#	$(PERL) distribution.pl < MANIFEST
 
 parser.c : cola.y
 	$(YACC) -d -o parser.c cola.y
@@ -127,5 +133,17 @@
 	$(CC) $(DEBUG) -o colacc$(EXE) parser$(O) lexer$(O) gen$(O) semant$(O) sym$(O) type$(O) $(LIBS)
 
 test: default
-	cd .. && $(PERL) t/harness --languages=cola
+	cd .. && $(PERL) t/harness --languages=$(LANG)
+
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	./colacc$(EXE) examples/fib.cola
+
+install : installable
+	cp colacc$(EXE) $(DESTDIR)$(BIN_DIR)/parrot-colacc$(EXE)
+	ascii2man README > $(DESTDIR)$(MANDIR)/man1/parrot-colacc.1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
 
+installable : colacc$(EXE)
+	cp colacc$(EXE) $(BUILD_DIR)/installable_colacc$(EXE)
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/dotnet/config/Makefile.in src/parrot-0.6.4/languages/dotnet/config/Makefile.in
--- origsrc/parrot-0.6.4/languages/dotnet/config/Makefile.in	2008-06-24 17:20:00.000000000 +0000
+++ src/parrot-0.6.4/languages/dotnet/config/Makefile.in	2008-07-27 10:54:15.750000000 +0000
@@ -16,6 +16,7 @@
 PARROT   = ${trans_parrot_path}${slash}parrot${exe}
 MONOLIB  = ${trans_mono_lib_path}
 PBCMERGE = ${trans_parrot_path}${slash}pbc_merge${exe}
+PBC_TO_EXE = ${trans_parrot_path}${slash}pbc_to_exe.exe
 PMCBUILD = $(PERL) ${build_dir}${slash}tools${slash}build${slash}dynpmc.pl
 OPSBUILD = $(PERL) ${build_dir}${slash}tools${slash}build${slash}dynoplibs.pl
 DESTDIR  = ${build_dir}${slash}runtime${slash}parrot${slash}dynext
@@ -60,6 +61,8 @@
 all : pmc/dotnet$(LOAD_EXT) ops/dotnet_ops$(LOAD_EXT) src/it.pbc \
       src/builtins.pbc src/translib.pbc net2pbc.pbc
 
+installable : net2pbc.pbc installable_net2pbc$exe
+
 pmc/dotnet$(LOAD_EXT) : $(PMC_FILES) pmc/structures.h pmc/tableinfo.h
 	@cd $(PMCDIR) && $(PMCBUILD) generate $(PMCS)
 	@cd $(PMCDIR) && $(PMCBUILD) compile $(PMCS)
@@ -91,7 +94,17 @@
 	$(PBCMERGE) -o net2pbc.pbc src/net2pbc.pbc src/translib.pbc
 
 class-library : net2pbc.pbc
-${trans_class_library}
+	${trans_class_library}
+
+# regenerate the Makefile
+Makefile: config/Makefile.in
+	$(PERL) Configure.pl
+
+net2pbc$exe : net2pbc.pbc
+	$(PBC_TO_EXE) net2pbc.pbc
+
+installable_net2pbc$exe : net2pbc.pbc
+	$(PBC_TO_EXE) net2pbc.pbc --install
 
 
 # PER FILE RULES AND DEPENDENCIES
@@ -133,6 +146,15 @@
 test : all
 	$(PERL) -It t/harness
 
+# TODO: rename build_dir. basic run for missing libs
+installable_test : installable
+	installable_net2pbc$exe
+
+install : all installable
+	mkdir ${build_dir}${slash}runtime${slash}bin
+	cp installable_net2pbc$exe ${build_dir}${slash}runtime${slash}bin${slash}parrot-net2pbc$exe
+	@cd $(PMCDIR) && $(PMCBUILD) copy "--destination=$(DESTDIR)" $(PMCS)
+	@cd $(PMCDIR) && $(PMCBUILD) copy "--destination=$(DESTDIR)" $(OPLIBS)
 
 # CLEANUP TARGETS
 # ###############
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/lua/config/makefiles/root.in src/parrot-0.6.4/languages/lua/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/lua/config/makefiles/root.in	2008-06-24 17:19:59.000000000 +0000
+++ src/parrot-0.6.4/languages/lua/config/makefiles/root.in	2008-07-27 10:54:15.750000000 +0000
@@ -1,9 +1,14 @@
+# $Id$ -*- Makefile -*-
 # Copyright (C) 2005-2008, The Perl Foundation.
-# $Id$
 
 ## configuration settings
+LANG     = lua
 O        = @o@
 LOAD_EXT = @load_ext@
+BIN_DIR  = @bin_dir@
+LIB_DIR  = @lib_dir@
+DOC_DIR  = @doc_dir@
+MANDIR	 = @mandir@
 
 ## Setup some commands
 MAKE    = @make_c@
@@ -94,6 +99,8 @@
 GEN_PBC = \
  lua.pbc
 
+DOCS = MAINTAINER doc/running.pod doc/status.pod
+
 all: \
  $(PMCDIR)/lua_group$(LOAD_EXT) \
  $(LIB_PBCS) \
@@ -128,11 +135,15 @@
 	$(TGE) --output=src/POSTGrammar_gen.pir src/POSTGrammar.tg
 
 lua.pbc: lua.pir src/lua51.pir src/grammar51.pir src/lua51_gen.pir src/PASTGrammar_gen.pir src/POSTGrammar_gen.pir $(LIB_SRCS)
-	$(PARROT) -o lua.pbc --output-pbc lua.pir
+	$(PARROT) -o lua_i.pbc --output-pbc lua.pir
+	$(PBC_MERGE) -o lua.pbc lua_i.pbc ../../compilers/tge/TGE/Rule.pbc
 
 lua@exe@: lua.pbc
 	$(PBC_TO_EXE) lua.pbc
 
+installable_lua@exe@: lua.pbc
+	$(PBC_TO_EXE) lua.pbc --install
+
 $(LIBPATH)/lualibs.pbc: $(LIB_PBCS)
 	$(PBC_MERGE) -o $(LIBPATH)/lualibs.pbc $(LIB_PBCS)
 
@@ -244,6 +255,15 @@
 test: all
 	cd .. && $(PERL) t/harness --languages=lua
 
+# TODO: rename build_dir. basic run for missing libs
+test-installable : installable
+	echo "a=1" | ./installable_$(LANG)@exe@
+
+install : installable
+	cp installable_$(LANG)@exe@ $(DESTDIR)$(BIN_DIR)/parrot-$(LANG)@exe@
+	pod2man doc/running.pod > $(DESTDIR)$(MANDIR)/man1/parrot-$(LANG).1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
 
 TEST_CLEANERS = \
  "t/pmc/*.pir" \
@@ -258,6 +278,7 @@
 
 BUILD_CLEANERS = \
  lua@exe@ \
+ installable_lua@exe@ \
  lua$(O) \
  lua.c \
  "*.pbc" \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/perl6/config/makefiles/root.in src/parrot-0.6.4/languages/perl6/config/makefiles/root.in
--- origsrc/parrot-0.6.4/languages/perl6/config/makefiles/root.in	2008-07-11 06:47:06.000000000 +0000
+++ src/parrot-0.6.4/languages/perl6/config/makefiles/root.in	2008-07-27 11:34:17.968750000 +0000
@@ -1,4 +1,4 @@
-# $Id$
+# $Id$ -*- Makefile -*-
 
 # arguments we want to run parrot with
 PARROT_ARGS =
@@ -33,6 +33,7 @@
 #CONDITIONED_LINE(darwin):
 #CONDITIONED_LINE(darwin):# MACOSX_DEPLOYMENT_TARGET must be defined for OS X compilation/linking
 #CONDITIONED_LINE(darwin):export MACOSX_DEPLOYMENT_TARGET := @osx_version@
+DOCS = README MAINTAINER ROADMAP docs/compiler_overview.pod docs/glossary.pod docs/STATUS
 
 all: perl6.pbc
 
@@ -113,6 +114,9 @@
 perl6.pbc: $(PARROT) $(SOURCES)
 	$(PARROT) $(PARROT_ARGS) -o perl6.pbc perl6.pir
 
+installable_perl6$(EXE): perl6.pbc
+	$(PBC_TO_EXE) perl6.pbc --install
+
 src/gen_grammar.pir: $(PERL6GRAMMAR) src/parser/grammar.pg src/parser/grammar-oper.pg
 	$(PARROT) $(PARROT_ARGS) $(PERL6GRAMMAR) \
 	    --output=src/gen_grammar.pir \
@@ -213,6 +217,16 @@
 t/spec:
 	svn co http:////svn.pugscode.org//pugs//t//spec t/spec
 
+installable : installable_perl6@exe@ $(PERL6_GROUP)
+	cp installable_perl6@exe@ $(BUILD_DIR)
+	cd $(PMC_DIR) && $(BUILD_DYNPMC) copy --destination=$(PARROT_DYNEXT) $(PMCS)
+
+install : installable
+	cp installable_perl6@exe@ $(DESTDIR)$(BIN_DIR)/perl6@exe@
+	$(POD2MAN) docs/running.pod > $(DESTDIR)$(MANDIR)/man1/perl6.1
+	mkdir $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+	cp $(DOCS) $(DESTDIR)$(DOC_DIR)/languages/$(LANG)
+
 CLEANUPS = \
   perl6.pbc \
   perl6.c \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/perl6/docs/running.pod src/parrot-0.6.4/languages/perl6/docs/running.pod
--- origsrc/parrot-0.6.4/languages/perl6/docs/running.pod	1970-01-01 00:00:00.000000000 +0000
+++ src/parrot-0.6.4/languages/perl6/docs/running.pod	2008-07-27 11:32:31.031250000 +0000
@@ -0,0 +1,15 @@
+=head1 NAME
+
+perl6
+
+=head1 SYNOPSIS
+
+Usage: perl6 [switches] [--] [programfile] [arguments]
+  -c                   check syntax only (runs BEGIN and CHECK blocks)
+  -e program           one line of program
+  -h, --help           display this help text
+  --target=[stage]     specify compilation stage to emit
+  -t, --trace=[flags]  enable trace flags
+  --encoding=[mode]    specify string encoding mode
+  -o, --output=[name]  specify name of output file
+  -v, --version        display version information
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/urm/urmc src/parrot-0.6.4/languages/urm/urmc
--- origsrc/parrot-0.6.4/languages/urm/urmc	2008-02-23 18:27:38.000000000 +0000
+++ src/parrot-0.6.4/languages/urm/urmc	2008-07-27 10:54:15.750000000 +0000
@@ -18,7 +18,7 @@
 
 use strict;
 use FindBin;
-use lib "$FindBin::RealBin/../../lib";
+use lib "$FindBin::Bin/../../lib";
 
 use Data::Dumper;
 use Getopt::Long;
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/lib/Parrot/Config.pm src/parrot-0.6.4/lib/Parrot/Config.pm
--- origsrc/parrot-0.6.4/lib/Parrot/Config.pm	2008-02-23 18:27:18.000000000 +0000
+++ src/parrot-0.6.4/lib/Parrot/Config.pm	2008-07-27 10:54:15.765625000 +0000
@@ -19,7 +19,7 @@
 use strict;
 use warnings;
 
-eval 'use Parrot::Config::Generated';
+eval 'require Parrot::Config::Generated';
 if ($@) {
     die "\nParrot::Config is unavailable until you configure parrot.\n"
         . "Please run `perl Configure.pl`.\n\n";
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm src/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm
--- origsrc/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm	2008-06-24 19:59:15.000000000 +0000
+++ src/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm	2008-07-27 10:54:15.765625000 +0000
@@ -119,6 +119,7 @@
         cc              => $cc,
         win32_gcc       => '-lalpha32 -lalpha32 -lopenalpha32',
         win32_nongcc    => 'alpha.lib',
+        cygwin          => '-lalpha32 -lXalpha32', # optional
         darwin          => 'alphadarwin.lib',
         default         => '-lalpha',
     } );
@@ -134,10 +135,12 @@
 
 =over 4
 
-=item * MSWin32 with F<gcc> as the C-compiler.
+=item * MSWin32 with F<gcc> as the C-compiler - Mingw.
 
 =item * MSWin32 with any C-compiler other than F<gcc>.
 
+=item * Cygwin to override Mingw.
+
 =item * Darwin.
 
 =back
@@ -173,7 +176,7 @@
 
 =item * C<win32_gcc>
 
-Libraries to be added where OS is mswin32 and C-compiler is F<gcc>.
+Libraries to be added where OS is mswin32 or cygwin and C-compiler is F<gcc>.
 Single whitespace-delimited string.
 
 =item * C<win32_nongcc>
@@ -181,6 +184,12 @@
 Libraries to be added where OS is mswin32 and C-compiler is not F<gcc>.
 Single whitespace-delimited string.
 
+=item * C<cygwin>
+
+Optional libraries to be added where OS is cygwin. This overrides C<win32_gcc>
+if defined.
+Single whitespace-delimited string.
+
 =item * C<darwin>
 
 Libraries to be added where OS is Darwin.  Do not supply a value if the value
@@ -197,7 +206,8 @@
     my $args = shift;
     croak "_add_to_libs() takes hashref: $!" unless ref($args) eq 'HASH';
     my $platform =
-          (($args->{osname} =~ /mswin32/i ||
+           $args->{osname} =~ /cygwin/i      ? 'cygwin'
+        :(($args->{osname} =~ /mswin32/i ||
            $args->{osname} =~ /cygwin/i) &&
            $args->{cc} =~ /^gcc/i)          ? 'win32_gcc'
         :  $args->{osname} =~ /mswin32/i    ? 'win32_nongcc'
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/config.pir src/parrot-0.6.4/runtime/parrot/library/config.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/config.pir	2008-07-05 10:04:43.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/config.pir	2008-07-27 11:06:40.843750000 +0000
@@ -50,10 +50,19 @@
     .local string conf_file
     conf_file = interpinfo .INTERPINFO_RUNTIME_PREFIX
     conf_file .= "/runtime/parrot/include/config.fpmc"
-
+    stat $I0, conf_file, 0
+    if $I0 goto conf
+    
+    # If installed into /usr/lib/parrot, not /usr/runtime/parrot
+    # This logic has to be reversed when installed versions should run faster
+    # than source builds.
+    conf_file = interpinfo .INTERPINFO_RUNTIME_PREFIX
+    conf_file .= "/lib/parrot/include/config.fpmc"
+conf:
     open CONF, conf_file, "<"
     $I0 = defined CONF
     if $I0 goto ok1
+    
     printerr "Can't read '"
     printerr conf_file
     printerr "': "
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/ncurses.pir src/parrot-0.6.4/runtime/parrot/library/ncurses.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/ncurses.pir	2008-02-23 18:27:07.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/ncurses.pir	2008-07-27 10:54:15.765625000 +0000
@@ -1,6 +1,9 @@
 .sub __ncurses_init :load
 
 loadlib $P1, 'libform'
+if $P1 goto has_lib
+loadlib $P1, 'cygform-8'
+has_lib:
 dlfunc $P2, $P1, 'new_field', 'piiiiii'
 store_global 'ncurses::new_field', $P2
 dlfunc $P2, $P1, 'dup_field', 'ppii'
@@ -119,7 +122,9 @@
 store_global 'ncurses::data_behind', $P2
 
 loadlib $P1, 'libncurses'
-
+if $P1 goto has_lib1
+loadlib $P1, 'cygncurses-8'
+has_lib1:
 dlfunc $P2, $P1, 'keybound', 'tii'
 store_global 'ncurses::keybound', $P2
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/parrotlib.pir src/parrot-0.6.4/runtime/parrot/library/parrotlib.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/parrotlib.pir	2008-02-23 18:27:07.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/parrotlib.pir	2008-07-27 11:07:12.734375000 +0000
@@ -143,8 +143,19 @@
     stat $I0, name, 0
     if $I0 goto END
 
-    name = "runtime/parrot/dynext/"
+    concat name, ext
+    stat $I0, name, 0
+    if $I0 goto END
+
+    # This logic has to be reversed when installed versions should run faster
+    # than source builds.
+    .include "interpinfo.pasm"
+    name = interpinfo .INTERPINFO_RUNTIME_PREFIX
+    concat name, "lib/parrot/dynext/"
     concat name, request
+    stat $I0, name, 0
+    if $I0 goto END
+
     concat name, ext
     stat $I0, name, 0
     if $I0 goto END
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/postgres.pir src/parrot-0.6.4/runtime/parrot/library/postgres.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/postgres.pir	2008-03-16 09:53:34.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/postgres.pir	2008-07-27 10:54:15.765625000 +0000
@@ -5,6 +5,8 @@
 if $P1 goto has_lib
 loadlib $P1, 'pq'
 if $P1 goto has_lib
+loadlib $P1, 'cygpq'
+if $P1 goto has_lib
 $P2 = new 'Exception'
 $P2[0] = 'error loading libpg - loadlib failed'
 throw $P2
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/src/library.c src/parrot-0.6.4/src/library.c
--- origsrc/parrot-0.6.4/src/library.c	2008-07-12 12:45:23.000000000 +0000
+++ src/parrot-0.6.4/src/library.c	2008-07-27 10:54:15.765625000 +0000
@@ -143,41 +143,45 @@
     paths = pmc_new(interp, enum_class_ResizableStringArray);
     VTABLE_set_pmc_keyed_int(interp, lib_paths,
             PARROT_LIB_PATH_INCLUDE, paths);
+    /* favor runtime over buildtime */
+    entry = CONST_STRING(interp, "lib/parrot/include/");
+    VTABLE_push_string(interp, paths, entry);
+    entry = CONST_STRING(interp, "lib/parrot/");
+    VTABLE_push_string(interp, paths, entry);
+    /* TODO: avoid useless stats for runtime */
     entry = CONST_STRING(interp, "runtime/parrot/include/");
     VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "runtime/parrot/");
     VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "./");
     VTABLE_push_string(interp, paths, entry);
-    entry = CONST_STRING(interp, "lib/parrot/include/");
-    VTABLE_push_string(interp, paths, entry);
-    entry = CONST_STRING(interp, "lib/parrot/");
-    VTABLE_push_string(interp, paths, entry);
 
     /* define library paths */
     paths = pmc_new(interp, enum_class_ResizableStringArray);
     VTABLE_set_pmc_keyed_int(interp, lib_paths,
             PARROT_LIB_PATH_LIBRARY, paths);
+    /* favor runtime over buildtime */
+    entry = CONST_STRING(interp, "lib/parrot/library/");
+    VTABLE_push_string(interp, paths, entry);
+    entry = CONST_STRING(interp, "lib/parrot/");
+    VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "runtime/parrot/library/");
     VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "runtime/parrot/");
     VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "./");
     VTABLE_push_string(interp, paths, entry);
-    entry = CONST_STRING(interp, "lib/parrot/library/");
-    VTABLE_push_string(interp, paths, entry);
-    entry = CONST_STRING(interp, "lib/parrot/");
-    VTABLE_push_string(interp, paths, entry);
 
     /* define dynext paths */
     paths = pmc_new(interp, enum_class_ResizableStringArray);
     VTABLE_set_pmc_keyed_int(interp, lib_paths,
             PARROT_LIB_PATH_DYNEXT, paths);
-    entry = CONST_STRING(interp, "runtime/parrot/dynext/");
+    /* favor runtime over buildtime */
+    entry = CONST_STRING(interp, "lib/parrot/dynext/");
     VTABLE_push_string(interp, paths, entry);
     entry = CONST_STRING(interp, "");
     VTABLE_push_string(interp, paths, entry);
-    entry = CONST_STRING(interp, "lib/parrot/dynext/");
+    entry = CONST_STRING(interp, "runtime/parrot/dynext/");
     VTABLE_push_string(interp, paths, entry);
 
     /* shared exts */
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/src/parrot_debugger.c src/parrot-0.6.4/src/parrot_debugger.c
--- origsrc/parrot-0.6.4/src/parrot_debugger.c	1970-01-01 00:00:00.000000000 +0000
+++ src/parrot-0.6.4/src/parrot_debugger.c	2008-07-27 10:54:15.781250000 +0000
@@ -0,0 +1,304 @@
+/*
+Copyright (C) 2001-2008, The Perl Foundation.
+$Id$
+
+=head1 NAME
+
+parrot_debugger - The Parrot debugger
+
+=head1 SYNOPSIS
+
+ parrot_debugger programfile
+
+=head1 DESCRIPTION
+
+=head2 Commands
+
+=over 4
+
+=item C<disassemble>
+
+Disassemble the bytecode.
+
+Use this if you have a PBC file but not the PASM.
+
+=item C<load>
+
+Load a source code file.
+
+=item C<list> or C<l>
+
+List the source code file.
+
+=item C<run> or C<r>
+
+Run the program.
+
+=item C<break> or C<b>
+
+Add a breakpoint.
+
+=item C<watch> or C<w>
+
+Add a watchpoint.
+
+=item C<delete> or C<d>
+
+Delete a breakpoint.
+
+=item C<disable>
+
+Disable a breakpoint.
+
+=item C<enable>
+
+Reenable a disabled breakpoint.
+
+=item C<continue> or C<c>
+
+Continue the program execution.
+
+=item C<next> or C<n>
+
+Run the next instruction
+
+=item C<eval> or C<e>
+
+Run an instruction.
+
+=item C<trace> or C<t>
+
+Trace the next instruction.
+
+=item C<print> or C<p>
+
+Print the interpreter registers.
+
+=item C<stack> or C<s>
+
+Examine the stack.
+
+=item C<info>
+
+Print interpreter information.
+
+=item C<quit> or C<q>
+
+Exit the debugger.
+
+=item C<help> or C<h>
+
+Print the help.
+
+=back
+
+=head2 Debug Ops
+
+You can also debug Parrot code by using the C<debug_init>, C<debug_load>
+and C<debug_break> ops in F<ops/debug.ops>.
+
+=over 4
+
+=cut
+
+*/
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <ctype.h>
+#include "../compilers/imcc/imc.h"
+#include "../compilers/imcc/parser.h"
+#include "parrot/embed.h"
+
+static void PDB_printwelcome(void);
+static void PDB_run_code(Parrot_Interp interp, int argc, char *argv[]);
+
+/*
+
+=item C<int main(int argc, char *argv[])>
+
+Reads the PASM or PBC file from argv[1], loads it, and then calls
+Parrot_debug().
+
+=cut
+
+*/
+
+int
+main(int argc, char *argv[])
+{
+    Parrot_Interp     debugger = Parrot_new(NULL);
+    Parrot_Interp     interp   = Parrot_new(debugger);
+    PDB_t            *pdb      = mem_allocate_zeroed_typed(PDB_t);
+    const char       *filename;
+    char             *ext;
+    void             *yyscanner;
+
+    /*Parrot_set_config_hash();  TODO link with cfg */
+
+    /* attach pdb structure */
+    debugger->pdb    = pdb;
+    interp->debugger = debugger;
+    pdb->debugee     = interp;
+
+    Parrot_block_GC_mark(interp);
+    Parrot_block_GC_sweep(interp);
+
+    do_yylex_init(interp, &yyscanner);
+
+    if (argc < 2) {
+        fprintf(stderr, "Usage: parrot_debugger programfile [program-options]\n");
+        Parrot_exit(interp, 1);
+    }
+
+    filename = argv[1];
+    ext      = strrchr(filename, '.');
+
+    if (ext && STREQ(ext, ".pbc")) {
+        Parrot_PackFile pf = Parrot_readbc(interp, filename);
+
+        if (!pf)
+            return 1;
+
+        Parrot_loadbc(interp, pf);
+    }
+    else {
+        Parrot_PackFile pf        = PackFile_new(interp, 0);
+        int             pasm_file = 0;
+
+        Parrot_loadbc(interp, pf);
+
+        IMCC_push_parser_state(interp);
+        IMCC_INFO(interp)->state->file = filename;
+
+        if (!(imc_yyin_set(fopen(filename, "r"), yyscanner)))    {
+            IMCC_fatal_standalone(interp, E_IOError,
+                    "Error reading source file %s.\n",
+                    filename);
+        }
+
+        if (ext && STREQ(ext, ".pasm"))
+            pasm_file = 1;
+
+        emit_open(interp, 1, NULL);
+        IMCC_INFO(interp)->state->pasm_file = pasm_file;
+        yyparse(yyscanner, interp);
+        imc_compile_all_units(interp);
+
+        imc_cleanup(interp, yyscanner);
+
+        fclose(imc_yyin_get(yyscanner));
+        PackFile_fixup_subs(interp, PBC_POSTCOMP, NULL);
+    }
+
+    Parrot_unblock_GC_mark(interp);
+    Parrot_unblock_GC_sweep(interp);
+
+    PDB_printwelcome();
+
+    PDB_run_code(interp, argc - 1, argv + 1);
+
+
+    Parrot_exit(interp, 0);
+}
+
+/*
+
+=item C<static void PDB_add_exception_handler(Parrot_Interp)>
+
+Adds a default exception handler to PDB.
+
+*/
+
+static void
+PDB_run_code(Parrot_Interp interp, int argc, char *argv[])
+{
+    Parrot_exception exp;
+
+    if (setjmp(exp.destination)) {
+        char *msg = string_to_cstring(interp, interp->exceptions->msg);
+        fprintf(stderr, "Caught exception: %s\n", msg);
+        string_cstring_free(msg);
+        return;
+    }
+
+    push_new_c_exception_handler(interp, &exp);
+
+    Parrot_runcode(interp, argc - 1, argv + 1);
+}
+
+/*
+
+=item C<static void PDB_printwelcome(void)>
+
+Prints out the welcome string.
+
+=cut
+
+*/
+
+static void
+PDB_printwelcome(void)
+{
+    fprintf(stderr, "Parrot Debugger 0.4.x\n");
+    fprintf(stderr, "\nPlease note: ");
+    fprintf(stderr, "the debugger is currently under reconstruction\n");
+}
+
+/*
+
+=back
+
+=head1 SEE ALSO
+
+F<src/debug.c>, F<include/parrot/debug.h>.
+
+=head1 HISTORY
+
+=over 4
+
+=item * Initial version by Daniel Grunblatt on 2002.5.19.
+
+=item * Start of rewrite - leo 2005.02.16
+
+The debugger now uses it's own interpreter. User code is run in
+Interp* debugee. We have:
+
+  debug_interp->pdb->debugee->debugger
+    ^                            |
+    |                            v
+    +------------- := -----------+
+
+Debug commands are mostly run inside the C<debugger>. User code
+runs of course in the C<debugee>.
+
+=back
+
+=head1 TODO
+
+=over 4
+
+=item * Check the user input for bad commands, it's quite easy to make
+it bang now, try listing the source before loading or disassembling it.
+
+=item * Print the interpreter info.
+
+=item * Make the user interface better (add comands
+history/completion).
+
+=item * Some other things I don't remember now because it's late.
+
+
+=back
+
+=cut
+
+*/
+
+
+/*
+ * Local variables:
+ *   c-file-style: "parrot"
+ * End:
+ * vim: expandtab shiftwidth=4:
+ */
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/src/pdb.c src/parrot-0.6.4/src/pdb.c
--- origsrc/parrot-0.6.4/src/pdb.c	2008-07-03 06:49:25.000000000 +0000
+++ src/parrot-0.6.4/src/pdb.c	1970-01-01 00:00:00.000000000 +0000
@@ -1,304 +0,0 @@
-/*
-Copyright (C) 2001-2008, The Perl Foundation.
-$Id$
-
-=head1 NAME
-
-pdb - The Parrot debugger
-
-=head1 SYNOPSIS
-
- pdb programfile
-
-=head1 DESCRIPTION
-
-=head2 Commands
-
-=over 4
-
-=item C<disassemble>
-
-Disassemble the bytecode.
-
-Use this if you have a PBC file but not the PASM.
-
-=item C<load>
-
-Load a source code file.
-
-=item C<list> or C<l>
-
-List the source code file.
-
-=item C<run> or C<r>
-
-Run the program.
-
-=item C<break> or C<b>
-
-Add a breakpoint.
-
-=item C<watch> or C<w>
-
-Add a watchpoint.
-
-=item C<delete> or C<d>
-
-Delete a breakpoint.
-
-=item C<disable>
-
-Disable a breakpoint.
-
-=item C<enable>
-
-Reenable a disabled breakpoint.
-
-=item C<continue> or C<c>
-
-Continue the program execution.
-
-=item C<next> or C<n>
-
-Run the next instruction
-
-=item C<eval> or C<e>
-
-Run an instruction.
-
-=item C<trace> or C<t>
-
-Trace the next instruction.
-
-=item C<print> or C<p>
-
-Print the interpreter registers.
-
-=item C<stack> or C<s>
-
-Examine the stack.
-
-=item C<info>
-
-Print interpreter information.
-
-=item C<quit> or C<q>
-
-Exit the debugger.
-
-=item C<help> or C<h>
-
-Print the help.
-
-=back
-
-=head2 Debug Ops
-
-You can also debug Parrot code by using the C<debug_init>, C<debug_load>
-and C<debug_break> ops in F<ops/debug.ops>.
-
-=over 4
-
-=cut
-
-*/
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <ctype.h>
-#include "../compilers/imcc/imc.h"
-#include "../compilers/imcc/parser.h"
-#include "parrot/embed.h"
-
-static void PDB_printwelcome(void);
-static void PDB_run_code(Parrot_Interp interp, int argc, char *argv[]);
-
-/*
-
-=item C<int main(int argc, char *argv[])>
-
-Reads the PASM or PBC file from argv[1], loads it, and then calls
-Parrot_debug().
-
-=cut
-
-*/
-
-int
-main(int argc, char *argv[])
-{
-    Parrot_Interp     debugger = Parrot_new(NULL);
-    Parrot_Interp     interp   = Parrot_new(debugger);
-    PDB_t            *pdb      = mem_allocate_zeroed_typed(PDB_t);
-    const char       *filename;
-    char             *ext;
-    void             *yyscanner;
-
-    /*Parrot_set_config_hash();  TODO link with cfg */
-
-    /* attach pdb structure */
-    debugger->pdb    = pdb;
-    interp->debugger = debugger;
-    pdb->debugee     = interp;
-
-    Parrot_block_GC_mark(interp);
-    Parrot_block_GC_sweep(interp);
-
-    do_yylex_init(interp, &yyscanner);
-
-    if (argc < 2) {
-        fprintf(stderr, "Usage: pdb programfile [program-options]\n");
-        Parrot_exit(interp, 1);
-    }
-
-    filename = argv[1];
-    ext      = strrchr(filename, '.');
-
-    if (ext && STREQ(ext, ".pbc")) {
-        Parrot_PackFile pf = Parrot_readbc(interp, filename);
-
-        if (!pf)
-            return 1;
-
-        Parrot_loadbc(interp, pf);
-    }
-    else {
-        Parrot_PackFile pf        = PackFile_new(interp, 0);
-        int             pasm_file = 0;
-
-        Parrot_loadbc(interp, pf);
-
-        IMCC_push_parser_state(interp);
-        IMCC_INFO(interp)->state->file = filename;
-
-        if (!(imc_yyin_set(fopen(filename, "r"), yyscanner)))    {
-            IMCC_fatal_standalone(interp, E_IOError,
-                    "Error reading source file %s.\n",
-                    filename);
-        }
-
-        if (ext && STREQ(ext, ".pasm"))
-            pasm_file = 1;
-
-        emit_open(interp, 1, NULL);
-        IMCC_INFO(interp)->state->pasm_file = pasm_file;
-        yyparse(yyscanner, interp);
-        imc_compile_all_units(interp);
-
-        imc_cleanup(interp, yyscanner);
-
-        fclose(imc_yyin_get(yyscanner));
-        PackFile_fixup_subs(interp, PBC_POSTCOMP, NULL);
-    }
-
-    Parrot_unblock_GC_mark(interp);
-    Parrot_unblock_GC_sweep(interp);
-
-    PDB_printwelcome();
-
-    PDB_run_code(interp, argc - 1, argv + 1);
-
-
-    Parrot_exit(interp, 0);
-}
-
-/*
-
-=item C<static void PDB_add_exception_handler(Parrot_Interp)>
-
-Adds a default exception handler to PDB.
-
-*/
-
-static void
-PDB_run_code(Parrot_Interp interp, int argc, char *argv[])
-{
-    Parrot_exception exp;
-
-    if (setjmp(exp.destination)) {
-        char *msg = string_to_cstring(interp, interp->exceptions->msg);
-        fprintf(stderr, "Caught exception: %s\n", msg);
-        string_cstring_free(msg);
-        return;
-    }
-
-    push_new_c_exception_handler(interp, &exp);
-
-    Parrot_runcode(interp, argc - 1, argv + 1);
-}
-
-/*
-
-=item C<static void PDB_printwelcome(void)>
-
-Prints out the welcome string.
-
-=cut
-
-*/
-
-static void
-PDB_printwelcome(void)
-{
-    fprintf(stderr, "Parrot Debugger 0.4.x\n");
-    fprintf(stderr, "\nPlease note: ");
-    fprintf(stderr, "the debugger is currently under reconstruction\n");
-}
-
-/*
-
-=back
-
-=head1 SEE ALSO
-
-F<src/debug.c>, F<include/parrot/debug.h>.
-
-=head1 HISTORY
-
-=over 4
-
-=item * Initial version by Daniel Grunblatt on 2002.5.19.
-
-=item * Start of rewrite - leo 2005.02.16
-
-The debugger now uses it's own interpreter. User code is run in
-Interp* debugee. We have:
-
-  debug_interp->pdb->debugee->debugger
-    ^                            |
-    |                            v
-    +------------- := -----------+
-
-Debug commands are mostly run inside the C<debugger>. User code
-runs of course in the C<debugee>.
-
-=back
-
-=head1 TODO
-
-=over 4
-
-=item * Check the user input for bad commands, it's quite easy to make
-it bang now, try listing the source before loading or disassembling it.
-
-=item * Print the interpreter info.
-
-=item * Make the user interface better (add comands
-history/completion).
-
-=item * Some other things I don't remember now because it's late.
-
-
-=back
-
-=cut
-
-*/
-
-
-/*
- * Local variables:
- *   c-file-style: "parrot"
- * End:
- * vim: expandtab shiftwidth=4:
- */
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/t/tools/parrot_debugger.t src/parrot-0.6.4/t/tools/parrot_debugger.t
--- origsrc/parrot-0.6.4/t/tools/parrot_debugger.t	1970-01-01 00:00:00.000000000 +0000
+++ src/parrot-0.6.4/t/tools/parrot_debugger.t	2008-07-27 10:54:15.890625000 +0000
@@ -0,0 +1,122 @@
+#! perl
+# Copyright (C) 2007, The Perl Foundation.
+# $Id$
+
+=head1 NAME
+
+t/tools/parrot_debugger.t - test the Parrot Debugger
+
+=head1 SYNOPSIS
+
+    % prove t/tools/parrot_debugger.t
+
+
+=head1 DESCRIPTION
+
+Tests the C<parrot_debugger> tool by providing it with a number of source files,
+and running through it with various commands.
+
+We never actually check the *full* output of parrot_debugger.  We simply check
+several smaller components to avoid a test file that is far too unwieldy.
+
+
+=head1 REQUIREMENTS
+
+This test script requires you to build parrot_debugger, by typing "make
+parrot_debugger" (using a suitable make tool for your platform).  If this
+requirement has not been met, all tests will be skipped.
+
+=cut
+
+use strict;
+use warnings;
+use lib qw(lib);
+
+use Test::More;
+use IO::File;
+use Parrot::Config;
+use File::Spec;
+
+my $path_to_pdb;
+
+BEGIN {
+    $path_to_pdb = File::Spec->catfile( ".", "pdb" );
+    my $exefile = $path_to_pdb . $PConfig{exe};
+    unless ( -f $exefile ) {
+        plan skip_all => "pdb hasn't been built";
+        exit(0);
+    }
+}
+
+my $tests = 0;
+
+ok( pdb_output_like( <<PIR, "pir", "help", 'List of commands:' ), "help page" );
+.sub main :main
+    \$N3 = 3.14159
+    print \$N3
+    print "\\n"
+.end
+PIR
+ok( pdb_output_like( <<PIR, "pir", "r", '3\.14159' ), "running the program" );
+.sub main :main
+    \$N3 = 3.14159
+    print \$N3
+    print "\\n"
+.end
+PIR
+BEGIN { $tests += 2 }
+
+BEGIN { plan tests => $tests; }
+
+=head1 HELPER SUBROUTINES
+
+=head2 pdb_output_like
+
+    ok(pdb_output_like(<<PASM, "pasm", 'r', "some output"), "running $file");
+
+Takes 4 arguments: a file to run, the filename-extension of the file
+(probably "pir" or "pasm"), the command or commands to provide to pdb as
+input, and a regex string to match within pdb's output.
+
+=cut
+
+my $testno = 0;
+
+sub pdb_output_like {
+    my ( $file, $ext, $input, $check ) = @_;
+    $testno++;
+    my $codefn   = "$0.$testno.$ext";
+    my $stdinfn  = "$0.$testno.stdin";
+    my $stdoutfn = "$0.$testno.stdout";
+    my $f        = IO::File->new(">$codefn");
+    $f->print($file);
+    $f->close();
+    $f = IO::File->new(">$stdinfn");
+    $f->print($input);
+    $f->print("\nquit\n");
+    $f->close();
+    system("$path_to_pdb $codefn <$stdinfn >$stdoutfn 2>&1");
+    $f = IO::File->new($stdoutfn);
+    my $output = join( "", <$f> );
+    return $output =~ /$check/;
+}
+
+=head1 TODO
+
+=over 4
+
+=item
+
+Flesh it out.  This is a bare bones proof of concept.  Add tests for all of the
+commands.
+
+=back
+
+=cut
+
+# Local Variables:
+#   mode: cperl
+#   cperl-indent-level: 4
+#   fill-column: 80
+# End:
+# vim: expandtab shiftwidth=4:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/t/tools/pdb.t src/parrot-0.6.4/t/tools/pdb.t
--- origsrc/parrot-0.6.4/t/tools/pdb.t	2008-02-23 18:27:29.000000000 +0000
+++ src/parrot-0.6.4/t/tools/pdb.t	1970-01-01 00:00:00.000000000 +0000
@@ -1,123 +0,0 @@
-#! perl
-# Copyright (C) 2007, The Perl Foundation.
-# $Id$
-
-=head1 NAME
-
-t/tools/pdb.t - test the Parrot Debugger
-
-=head1 SYNOPSIS
-
-    % prove t/tools/pdb.t
-
-
-=head1 DESCRIPTION
-
-Tests the C<pdb> tool by providing it with a number of source files,
-and running through it with various commands.
-
-We never actually check the *full* output of pdb.  We simply check
-several smaller components to avoid a test file that is far too
-unwieldy.
-
-
-=head1 REQUIREMENTS
-
-This test script requires you to build pdb, by typing "make pdb" (using
-a suitable make tool for your platform).  If this requirement has not
-been met, all tests will be skipped.
-
-=cut
-
-use strict;
-use warnings;
-use lib qw(lib);
-
-use Test::More;
-use IO::File;
-use Parrot::Config;
-use File::Spec;
-
-my $path_to_pdb;
-
-BEGIN {
-    $path_to_pdb = File::Spec->catfile( ".", "pdb" );
-    my $exefile = $path_to_pdb . $PConfig{exe};
-    unless ( -f $exefile ) {
-        plan skip_all => "pdb hasn't been built";
-        exit(0);
-    }
-}
-
-my $tests = 0;
-
-ok( pdb_output_like( <<PIR, "pir", "help", 'List of commands:' ), "help page" );
-.sub main :main
-    \$N3 = 3.14159
-    print \$N3
-    print "\\n"
-.end
-PIR
-ok( pdb_output_like( <<PIR, "pir", "r", '3\.14159' ), "running the program" );
-.sub main :main
-    \$N3 = 3.14159
-    print \$N3
-    print "\\n"
-.end
-PIR
-BEGIN { $tests += 2 }
-
-BEGIN { plan tests => $tests; }
-
-=head1 HELPER SUBROUTINES
-
-=head2 pdb_output_like
-
-    ok(pdb_output_like(<<PASM, "pasm", 'r', "some output"), "running $file");
-
-Takes 4 arguments: a file to run, the filename-extension of the file
-(probably "pir" or "pasm"), the command or commands to provide to pdb as
-input, and a regex string to match within pdb's output.
-
-=cut
-
-my $testno = 0;
-
-sub pdb_output_like {
-    my ( $file, $ext, $input, $check ) = @_;
-    $testno++;
-    my $codefn   = "$0.$testno.$ext";
-    my $stdinfn  = "$0.$testno.stdin";
-    my $stdoutfn = "$0.$testno.stdout";
-    my $f        = IO::File->new(">$codefn");
-    $f->print($file);
-    $f->close();
-    $f = IO::File->new(">$stdinfn");
-    $f->print($input);
-    $f->print("\nquit\n");
-    $f->close();
-    system("$path_to_pdb $codefn <$stdinfn >$stdoutfn 2>&1");
-    $f = IO::File->new($stdoutfn);
-    my $output = join( "", <$f> );
-    return $output =~ /$check/;
-}
-
-=head1 TODO
-
-=over 4
-
-=item
-
-Flesh it out.  This is a bare bones proof of concept.  Add tests for all of the
-commands.
-
-=back
-
-=cut
-
-# Local Variables:
-#   mode: cperl
-#   cperl-indent-level: 4
-#   fill-column: 100
-# End:
-# vim: expandtab shiftwidth=4:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/tools/dev/install_files.pl src/parrot-0.6.4/tools/dev/install_files.pl
--- origsrc/parrot-0.6.4/tools/dev/install_files.pl	2008-05-11 12:57:40.000000000 +0000
+++ src/parrot-0.6.4/tools/dev/install_files.pl	2008-07-27 10:54:15.906250000 +0000
@@ -126,7 +126,7 @@
     bindir      => '/usr/bin',
     libdir      => '/usr/lib',
     includedir  => '/usr/include',
-    docdir      => '/usr/share/doc',
+    docdir      => '/usr/share/doc/parrot',
     'dry-run'   => 0,
 );
 
@@ -189,6 +189,7 @@
     }
     elsif ( $meta{include} ) {
         $dest =~ s/^include//;
+        $dest =~ s/^src/parrot/;
         $dest = File::Spec->catdir( $options{includedir}, $dest );
     }
     elsif ( $meta{doc} ) {
@@ -197,13 +198,16 @@
     elsif ( $meta{pkgconfig} ) {
 
         # For the time being this is hardcoded as being installed under libdir
-        # as it is typically donw with automake installed packages.  If there
+        # as it is typically done with automake installed packages.  If there
         # is a use case to make this configurable we'll add a seperate
         # --pkgconfigdir option.
         $dest = File::Spec->catdir( $options{libdir}, 'pkgconfig', $dest );
     }
     else {
-        $dest =~ s/^runtime/lib/ if /\[library]/;
+        $dest =~ s|^runtime/|lib/|; # if /\[library]/;
+        # $dest =~ s|^src/|src/parrot/|;
+        $dest =~ s|^src/|lib/parrot/src/|;
+	next if $dest =~ /compilers|config|language|tools/;
         $dest = File::Spec->catdir( $options{prefix}, $dest );
     }
 
@@ -243,6 +247,7 @@
     }
     else {
         next unless -e $src;
+        next if $^O eq 'cygwin' and -e "$src.exe"; # cygwin stat works, but copy not
         copy( $src, $dest ) or die "copy $src to $dest: $!\n";
         print "$dest\n";
     }
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl src/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl
--- origsrc/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl	2008-06-30 09:34:12.000000000 +0000
+++ src/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl	2008-07-27 10:54:15.906250000 +0000
@@ -11,6 +11,22 @@
 __END__
 #! parrot
 
+=head1 TITLE
+
+pbc_to_exe
+
+=head2 SYNOPSIS
+
+  pbc_to_exe my.pbc
+  => my.exe
+
+  pbc_to_exe my.pbc --install
+  => installable_my.exe
+
+Warning! With -install there must be no directory prefix in the first arg yet.
+
+=cut
+
 .include 'library/config.pir'
 
 .sub 'main' :main
@@ -54,8 +70,40 @@
     argc = args
 
     if argc == 2 goto proper_args
+    if argc == 3 goto check_install
     .return ()
 
+check_install:
+    .local string infile, install
+
+    $P0    = shift args
+    infile = shift args
+    install = shift args
+    if install == '--install' goto proper_install
+    .return ()
+
+proper_install:
+    .local string cfile, objfile, obj, exefile, exe
+
+    $P0    = '_config'()
+    obj    = $P0['o']
+    exe    = $P0['exe']
+
+    .local int infile_len
+    infile_len  = length infile
+    infile_len -= 3
+
+    cfile       = substr infile, 0, infile_len
+    cfile      .= 'c'
+
+    dec infile_len
+    objfile     = substr infile, 0, infile_len
+    exefile     = 'installable_'
+    exefile    .= objfile
+    exefile    .= exe
+    objfile    .= obj
+    .return(infile, cfile, objfile, exefile)
+
 proper_args:
     .local string infile, cfile, objfile, obj, exefile, exe
 
@@ -270,6 +318,7 @@
 .sub 'compile_file'
     .param string cfile
     .param string objfile
+    .param int install :optional
 
     $P0 = '_config'()
     .local string cc, ccflags, cc_o_out, osname, build_dir, slash
@@ -318,6 +367,7 @@
 .sub 'link_file'
     .param string objfile
     .param string exefile
+    .param int install :optional
 
     $P0 = '_config'()
     .local string cc, ld, link_dynamic, linkflags, ld_out, libparrot, libs, o
@@ -336,11 +386,17 @@
     slash        = $P0['slash']
     icushared    = $P0['icu_shared']
 
-    .local string config, pathquote
+    .local string config, pathquote, exeprefix
+    exeprefix = substr exefile, 0, 12
     config     = concat build_dir, slash
     config    .= 'src'
     config    .= slash
+    if exeprefix == 'installable_' goto config_install
     config    .= 'parrot_config'
+    goto config_cont
+ config_install:
+    config    .= 'install_config'
+ config_cont:
     config    .= o
     pathquote  = ''
     unless osname == 'MSWin32' goto not_windows
@@ -361,6 +417,8 @@
     link .= objfile
     link .= pathquote
     link .= ' '
+    link .= config
+    link .= ' '
     link .= rpath
     link .= ' '
     link .= libparrot
@@ -372,8 +430,6 @@
     link .= libs
     link .= ' '
     link .= icushared
-    link .= ' '
-    link .= config
 
     say link
     .local int status
@@ -390,7 +446,7 @@
 
 
 # Local Variables:
-#   mode: cperl
+#   mode: pir
 #   cperl-indent-level: 4
 #   fill-column: 100
 # End:

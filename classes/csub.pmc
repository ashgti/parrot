/* CSub.pmc
 *  Copyright: 2001-2003 The Perl Foundation.  All Rights Reserved.
 *  CVS Info
 *     $Id$
 *  Overview:
 *     These are the vtable functions for the CSub base class
 *  Data Structure and Algorithms:
 *  History:
 *     Initial revision by sean 2002/08/04
 *  Notes:
 *  References:
 */

#include "parrot/parrot.h"
#include "parrot/method_util.h"

pmclass CSub {

    PMC* clone () {
	PMC* dest = pmc_new_noinit(INTERP, SELF->vtable->base_type);
	PMC_struct_val(dest) = PMC_struct_val(SELF);
	return dest;
    }

    PMC* get_pmc () {
        return SELF;
    }

    INTVAL is_same (PMC* value) {
        return SELF == value;
    }

    void set_same (PMC* value) {
        PMC_struct_val(SELF) = PMC_struct_val(value);
    }

    INTVAL is_equal (PMC* value) {
        return (SELF->vtable == value->vtable
                && PMC_struct_val(SELF) == PMC_struct_val(value));
    }

    INTVAL defined () {
        return PMC_struct_val(SELF) != NULL;
    }

    void* invoke (void * next) {
        Parrot_csub_t func =
		(Parrot_csub_t)D2FPTR(PMC_struct_val(SELF));
        func(INTERP, SELF);
        return next;
    }
}

/* intlist.pmc
 *  Copyright: 2001-2003 The Perl Foundation.  All Rights Reserved.
 *  CVS Info
 *     $Id$
 *  Overview:
 *     These are the vtable functions for the IntList class
 *  Data Structure and Algorithms:
 *  History:
 *  Notes:
 *  References:
 */

#include "parrot/parrot.h"

#define THROW_UNSUPPORTED internal_exception(INTERP_ERROR, "Operation not supported\n")

pmclass IntList need_ext {

    PMC* clone () {
	PMC* dest = pmc_new_noinit(INTERP, SELF->vtable->base_type);
        PObj_custom_mark_SET(dest);
        PMC_data(dest) = intlist_clone(INTERP, (IntList *) PMC_data(SELF));
	return dest;
    }

    void init () {
        PMC_data(SELF) = intlist_new(INTERP);
        PMC_int_val(SELF) = 0;
        PObj_custom_mark_SET(SELF);
    }

    void mark () {
        intlist_mark(INTERP, (IntList *) PMC_data(SELF));
    }

    void set_integer_keyed_int (INTVAL key, INTVAL value) {
        intlist_assign(INTERP, (IntList*) PMC_data(SELF), key, value);
    }

    void set_integer_keyed (PMC* key, INTVAL value) {
        INTVAL ix;

        if (!key) return;

        ix = key_integer(INTERP, key);
        intlist_assign(INTERP, (IntList*) PMC_data(SELF), ix, value);
    }

    INTVAL get_integer () {
        return intlist_length(INTERP, (IntList*) PMC_data(SELF));
    }

    INTVAL get_integer_keyed_int (INTVAL key) {
        return intlist_get(INTERP, (IntList*) PMC_data(SELF), key);
    }

    INTVAL get_integer_keyed (PMC* key) {
        INTVAL ix;
        if (!key) return 0;
        ix = key_integer(INTERP, key);
        return intlist_get(INTERP, (IntList*) PMC_data(SELF), ix);
    }

    void push_integer (INTVAL value) {
        intlist_push(INTERP, (IntList*) PMC_data(SELF), value);
    }

    INTVAL pop_integer() {
        return intlist_pop(INTERP, (IntList*) PMC_data(SELF));
    }

    void unshift_integer (INTVAL value) {
        intlist_unshift(INTERP, (IntList**) &PMC_data(SELF), value);
    }

    INTVAL shift_integer() {
        return intlist_shift(INTERP, (IntList**) &PMC_data(SELF));
    }

}

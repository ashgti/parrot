#
# Makefile.in
#
# $Id$
#

PERL = @perl@
RM_F = @rm_f@

DIR=languages/jako
TOOL_DIR=../..
JAKOC=$(PERL) -I lib jakoc
INTERP=../../@test_prog@
ASM=$(INTERP) -a --output-pbc

.SUFFIXES: .jako .pir .pbc


#
# Default target:
#

all: \
	examples/bench.pir      \
	examples/board.pir      \
	examples/euclid.pir     \
	examples/fact.pir       \
	examples/fib.pir        \
	examples/hello.pir      \
	examples/leibniz.pir    \
	examples/life.pir       \
	examples/mandelbrot.pir \
	examples/mandelzoom.pir \
	examples/mops.pir       \
	examples/nci.pir        \
	examples/primes.pir     \
	examples/queens.pir     \
	examples/sub.pir


#
# Compilation:
#

.jako.pir:
	$(JAKOC) $< > $@ || (rm -f $@ && false)

examples/bench.pir:      examples/bench.jako      jakoc
examples/board.pir:      examples/board.jako      jakoc
examples/euclid.pir:     examples/euclid.jako     jakoc
examples/fact.pir:       examples/fact.jako       jakoc
examples/fib.pir:        examples/fib.jako        jakoc
examples/hello.pir:      examples/hello.jako      jakoc
examples/leibniz.pir:    examples/leibniz.jako    jakoc
examples/life.pir:       examples/life.jako       jakoc
examples/mandelbrot.pir: examples/mandelbrot.jako jakoc
examples/mandelzoom.pir: examples/mandelzoom.jako jakoc
examples/mops.pir:       examples/mops.jako       jakoc
examples/nci.pir:        examples/nci.jako        jakoc
examples/primes.pir:     examples/primes.jako     jakoc
examples/queens.pir:     examples/queens.jako     jakoc
examples/sub.pir:        examples/sub.jako        jakoc

#
# Assembly:
#

.pir.pbc:
	$(ASM) -o $@ $<

examples/bench.pbc:      examples/bench.pir
examples/board.pbc:      examples/board.pir
examples/euclid.pbc:     examples/euclid.pir
examples/fact.pbc:       examples/fact.pir
examples/fib.pbc:        examples/fib.pir
examples/hello.pbc:      examples/hello.pir
examples/leibniz.pbc:    examples/leibniz.pir
examples/life.pbc:       examples/life.pir
examples/mandelbrot.pbc: examples/mandelbrot.pir
examples/mandelzoom.pbc: examples/mandelzoom.pir
examples/mops.pbc:       examples/mops.pir
examples/nci.pbc:        examples/nci.pir
examples/primes.pbc:     examples/primes.pir
examples/queens.pbc:     examples/queens.pir
examples/sub.pbc:        examples/sub.pir


#
# Other targets:
#

clean:
	$(RM_F) "examples/*.pir" "examples/*.list" "examples/*.pbc"

over:
	@$(MAKE) clean
	@$(MAKE) all

test: all
	$(INTERP) examples/bench.pbc
	$(INTERP) examples/board.pbc
	$(INTERP) examples/euclid.pbc
	$(INTERP) examples/fact.pbc
	$(INTERP) examples/fib.pbc
	$(INTERP) examples/hello.pbc
	$(INTERP) examples/leibniz.pbc
	$(INTERP) examples/life.pbc
	$(INTERP) examples/mandelbrot.pbc
	$(INTERP) examples/mandelzoom.pbc
	$(INTERP) examples/mops.pbc
	$(INTERP) examples/nci.pbc
	$(INTERP) examples/primes.pbc
	$(INTERP) examples/queens.pbc
	$(INTERP) examples/sub.pbc


#
# End of file.
#

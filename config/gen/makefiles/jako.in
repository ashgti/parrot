#
# Makefile.in
#
# $Id$
#

PERL = ${perl}
RM_F = ${rm_f}

DIR=languages/jako
TOOL_DIR=../..
JAKOC=$(PERL) -I lib jakoc
INTERP=../../${test_prog}
ASM=$(INTERP) -a --output-pbc

.SUFFIXES: .jako .imc .pbc


#
# Default target:
#

all: \
	examples/bench.imc      \
	examples/board.imc      \
	examples/euclid.imc     \
	examples/fact.imc       \
	examples/fib.imc        \
	examples/hello.imc      \
	examples/leibniz.imc    \
	examples/life.imc       \
	examples/mandelbrot.imc \
	examples/mandelzoom.imc \
	examples/mops.imc       \
	examples/nci.imc        \
	examples/primes.imc     \
	examples/queens.imc     \
	examples/sub.imc


#
# Compilation:
#

.jako.imc:
	$(JAKOC) $< > $@ || (rm -f $@ && false)

examples/bench.imc:      examples/bench.jako      jakoc
examples/board.imc:      examples/board.jako      jakoc
examples/euclid.imc:     examples/euclid.jako     jakoc
examples/fact.imc:       examples/fact.jako       jakoc
examples/fib.imc:        examples/fib.jako        jakoc
examples/hello.imc:      examples/hello.jako      jakoc
examples/leibniz.imc:    examples/leibniz.jako    jakoc
examples/life.imc:       examples/life.jako       jakoc
examples/mandelbrot.imc: examples/mandelbrot.jako jakoc
examples/mandelzoom.imc: examples/mandelzoom.jako jakoc
examples/mops.imc:       examples/mops.jako       jakoc
examples/nci.imc:        examples/nci.jako        jakoc
examples/primes.imc:     examples/primes.jako     jakoc
examples/queens.imc:     examples/queens.jako     jakoc
examples/sub.imc:        examples/sub.jako        jakoc

#
# Assembly:
#

.imc.pbc:
	$(ASM) -o $@ $<

examples/bench.pbc:      examples/bench.imc
examples/board.pbc:      examples/board.imc
examples/euclid.pbc:     examples/euclid.imc
examples/fact.pbc:       examples/fact.imc
examples/fib.pbc:        examples/fib.imc
examples/hello.pbc:      examples/hello.imc
examples/leibniz.pbc:    examples/leibniz.imc
examples/life.pbc:       examples/life.imc
examples/mandelbrot.pbc: examples/mandelbrot.imc
examples/mandelzoom.pbc: examples/mandelzoom.imc
examples/mops.pbc:       examples/mops.imc
examples/nci.pbc:        examples/nci.imc
examples/primes.pbc:     examples/primes.imc
examples/queens.pbc:     examples/queens.imc
examples/sub.pbc:        examples/sub.imc


#
# Other targets:
#

clean:
	$(RM_F) "examples/*.imc" "examples/*.list" "examples/*.pbc"

over:
	@$(MAKE) clean
	@$(MAKE) all

test: all
	$(INTERP) examples/bench.pbc
	$(INTERP) examples/board.pbc
	$(INTERP) examples/euclid.pbc
	$(INTERP) examples/fact.pbc
	$(INTERP) examples/fib.pbc
	$(INTERP) examples/hello.pbc
	$(INTERP) examples/leibniz.pbc
	$(INTERP) examples/life.pbc
	$(INTERP) examples/mandelbrot.pbc
	$(INTERP) examples/mandelzoom.pbc
	$(INTERP) examples/mops.pbc
	$(INTERP) examples/nci.pbc
	$(INTERP) examples/primes.pbc
	$(INTERP) examples/queens.pbc
	$(INTERP) examples/sub.pbc


#
# End of file.
#

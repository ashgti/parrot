/*
 * feature.h - arch specific defines resulting from some tests
 */


#if !defined(PARROT_FEATRUE_H_GUARD)
#define PARROT_FEATRUE_H_GUARD

#perl - all below here gets evaled by perl, OUT is the filehandle

	print OUT <<EOP;
/* from config/auto/memalign */
EOP
if (${memalign}) {
	print OUT <<EOP;
#include <malloc.h>
#define Parrot_memalign(a, s) memalign((a), (s))
EOP
} else {
	print OUT <<EOP;
#define Parrot_memalign(a, s) mem_sys_allocate(s)
EOP
}

	print OUT <<EOP;
/* from config/auto/isreg */
EOP
unless (${isreg}) {
	print OUT <<EOP;
#define BROKEN_ISREG 1
EOP
}

if (${jit_i386} && ${jit_i386} eq 'fcomip') {
    print OUT <<'END';

/* from config/auto/jit */
#ifdef I386
#  define HAS_JIT_FCOMIP
#endif
END
}

    print OUT <<'END';
#ifdef __powerpc__
#  define VA_TO_VAPTR(x) (x)
#else
#  define VA_TO_VAPTR(x) (&(x))
#endif
END

#endif guard
print OUT "\n\n#endif\n"

BUGS:

 - lexer doesn't impose limits on identifiers, this could lead
   to buffer overflows.
   So there are a bunch of strcats and sprintf's, some of them
   marked XXX, that are unsafe.


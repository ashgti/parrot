# Copyright (C) 2007-2009, The Perl Foundation.
# $Id$

=head1 Ubuntu Packaging Guide

This is a quick set of instructions for packaging Parrot for Ubuntu. See the he
Ubuntu Packaging Guide (https://wiki.ubuntu.com/PackagingGuide) and the guide
to the Person Package Archive (PPA) (https://help.launchpad.net/Packaging/PPA)
for more details.

This guide assumes that you're running in a chroot environment set up as in:
L<https://trac.parrot.org/parrot/wiki/ChrootSetup>, and also assumes that
you've already built the corresponding Debian package for the release as
documented in L<docs/project/debian_packaging_guide.pod>.

To package Parrot for Debian:

=over 4

=item 0.

Download the latest tarball.

=item 1.

Compile it and run the tests, just to be sure the tarball is sound (especially
useful if you're running in a chroot environment different than your usual dev
environment).

=item 2.

Create a new directory. (The name is irrelevant, but we'll use ~/udeb/parrot for
the sake of illustration.)

Create a fresh extract of the tarball in the ~/udeb/parrot directory. The
directory should be named "parrot-<version>" (it will be by default).

Copy the debian/ directory from the Parrot source tree into the fresh tarball
extract.

  cp -r <path/to/parrot/svn>/ports/debian ~/udeb/parrot/parrot-<version>/.

Copy the original tarball into ~/udeb/parrot, naming it
"parrot_<version>.orig.tar.gz" (note the "_" in place of dash).

=item 4.

Update the debian/changelog file in ~/udeb/parrot/parrot-<version>/ to add an
entry for the Ubuntu package. Copy the first line from the Debian changelog.
Add C<ubuntu#> after the Debian version to indicate the Ubuntu revision of the
package, and for PPA uploads also add C<~ppa#>. Change the Debian branch
('unstable') to the target Ubuntu distribution ('intrepid').

  parrot (0.5.1-1ubuntu1) intrepid; urgency=low

The changelog entry for the Ubuntu release is generally just:

  * New upstream release.

The final line gives the maintainer's name, email address, and the date. The
date must be in RFC822 format, and can be generated by running C<date -R>.
(Note that two spaces are required between the email and the date.)

   -- Your Name <you@example.org>  Sun, 30 Dec 2007 17:21:45 +0000

=item 8.

Install all dependencies:

  $ sudo /usr/lib/pbuilder/pbuilder-satisfydepends

=item 9.

Build the source packages. From ~/udeb/parrot/parrot_<version>/, run:

  $ debuild -S -sa

=item X.

Update Parrot's PPA with the new release (configured in ChrootSetup):

  $ dput parrot-ppa parrot_<version>_source.changes

=item 11.

Don't commit Ubuntu-specific changes to the debian/ directory in the
repository. (At the moment, we're keeping the Debian packages as the primary.)

=back

=head1 SEE ALSO

F<README>, F<RESPONSIBLE_PARTIES>.

=cut
